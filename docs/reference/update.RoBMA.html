<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Updates a fitted RoBMA object — update.RoBMA • RoBMA</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Updates a fitted RoBMA object — update.RoBMA" />
<meta property="og:description" content="update.RoBMA can be used to
add an additional model to an existing &quot;RoBMA&quot; object by
specifying either a null or alternative prior for each parameter
and the prior odds of the model (prior_odds), see the
vignette(&quot;CustomEnsembles&quot;) vignette,
change the prior odds of fitted models by specifying a vector
prior_odds of the same length as the fitted models,
refitting models that failed to converge with updated settings
of control parameters,
or changing the convergence criteria and recalculating the ensemble
results by specifying new control argument and setting
refit_failed == FALSE.

" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RoBMA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/CustomEnsembles.html">Fitting custom meta-analytic ensembles</a>
    </li>
    <li>
      <a href="../articles/ReproducingBMA.html">Reproducing BMA</a>
    </li>
    <li>
      <a href="../articles/WarningsAndErrors.html">Common warnings and errors</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/FBartos/RoBMA/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Updates a fitted RoBMA object</h1>
    <small class="dont-index">Source: <a href='https://github.com/FBartos/RoBMA/blob/master/R/main.R'><code>R/main.R</code></a></small>
    <div class="hidden name"><code>update.RoBMA.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>update.RoBMA</code> can be used to</p><ol>
<li><p>add an additional model to an existing <code>"RoBMA"</code> object by
specifying either a null or alternative prior for each parameter
and the prior odds of the model (<code>prior_odds</code>), see the
<code><a href='../articles/CustomEnsembles.html'>vignette("CustomEnsembles")</a></code> vignette,</p></li>
<li><p>change the prior odds of fitted models by specifying a vector
<code>prior_odds</code> of the same length as the fitted models,</p></li>
<li><p>refitting models that failed to converge with updated settings
of control parameters,</p></li>
<li><p>or changing the convergence criteria and recalculating the ensemble
results by specifying new <code>control</code> argument and setting
<code>refit_failed == FALSE</code>.</p></li>
</ol>

    </div>

    <pre class="usage"><span class='co'># S3 method for RoBMA</span>
<span class='fu'><a href='https://rdrr.io/r/stats/update.html'>update</a></span><span class='op'>(</span>
  <span class='va'>object</span>,
  refit_failed <span class='op'>=</span> <span class='cn'>TRUE</span>,
  prior_mu <span class='op'>=</span> <span class='cn'>NULL</span>,
  prior_tau <span class='op'>=</span> <span class='cn'>NULL</span>,
  prior_omega <span class='op'>=</span> <span class='cn'>NULL</span>,
  prior_odds <span class='op'>=</span> <span class='cn'>NULL</span>,
  prior_mu_null <span class='op'>=</span> <span class='cn'>NULL</span>,
  prior_tau_null <span class='op'>=</span> <span class='cn'>NULL</span>,
  prior_omega_null <span class='op'>=</span> <span class='cn'>NULL</span>,
  prior_sigma <span class='op'>=</span> <span class='cn'>NULL</span>,
  study_names <span class='op'>=</span> <span class='cn'>NULL</span>,
  control <span class='op'>=</span> <span class='cn'>NULL</span>,
  chains <span class='op'>=</span> <span class='cn'>NULL</span>,
  iter <span class='op'>=</span> <span class='cn'>NULL</span>,
  burnin <span class='op'>=</span> <span class='cn'>NULL</span>,
  thin <span class='op'>=</span> <span class='cn'>NULL</span>,
  parallel <span class='op'>=</span> <span class='cn'>NULL</span>,
  seed <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>a fitted RoBMA object.</p></td>
    </tr>
    <tr>
      <th>refit_failed</th>
      <td><p>whether failed models should be refitted. Relevant only
if new priors or <code>prior_odds</code> are not supplied. Defaults to <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>prior_mu</th>
      <td><p>a prior distribution for the <code>mu</code> parameter that
will be treated as belonging to the alternative hypothesis.</p></td>
    </tr>
    <tr>
      <th>prior_tau</th>
      <td><p>a prior distribution for the <code>tau</code> parameter that
will be treated as belonging to the alternative hypothesis.</p></td>
    </tr>
    <tr>
      <th>prior_omega</th>
      <td><p>a prior weight function for the <code>omega</code>
parameter that will be treated as belonging to the alternative hypothesis.</p></td>
    </tr>
    <tr>
      <th>prior_odds</th>
      <td><p>either a single value specifying prior model odds
of a newly specified model using priors argument, or a vector of the
same length as already fitted models to update their prior odds.</p></td>
    </tr>
    <tr>
      <th>prior_mu_null</th>
      <td><p>list of prior distribution for the <code>mu</code> parameter that
will be treated as belonging to the null hypothesis. Defaults to point distribution
with location at 0 (
<code><a href='prior.html'>prior(distribution = "point", parameters = list(location = 0))</a></code>).</p></td>
    </tr>
    <tr>
      <th>prior_tau_null</th>
      <td><p>a prior distribution for the <code>tau</code> parameter that
will be treated as belonging to the null hypothesis.</p></td>
    </tr>
    <tr>
      <th>prior_omega_null</th>
      <td><p>a prior weight function for the <code>omega</code> parameter
that will be treated as belonging to the null hypothesis.</p></td>
    </tr>
    <tr>
      <th>study_names</th>
      <td><p>an optional argument with the names of the studies.</p></td>
    </tr>
    <tr>
      <th>control</th>
      <td><p>a list of additional arguments for the MCMC algorithm.
Possible options are:</p><dl>
<dt>autofit</dt><dd><p>Whether the models should be refitted until convergence.
Defaults to <code>FALSE</code></p></dd>
<dt>max_error</dt><dd><p>The target MCMC error for the autofit function. The
argument is passed to <a href='https://rdrr.io/pkg/coda/man/raftery.diag.html'>raftery.diag</a> as 'r'. Defaults to
<code>.01</code>.</p></dd>
<dt>max_rhat</dt><dd><p>The target Rhat error for the autofit function. The
argument is passed to <a href='https://rdrr.io/pkg/runjags/man/add.summary.html'>add.summary</a> as 'psrf.target'.
Defaults to <code>1.05</code>.</p></dd>
<dt>max_time</dt><dd><p>A string specifying the maximum fitting time in case
of autofit. Defaults to <code>Inf</code>. Can be specified as a number and
a unit (Acceptable units include ’seconds’, ’minutes’, ’hours’, ’days’,
’weeks’, or the first letter(s) of each), i.e. <code>"1hr"</code>.</p></dd>
<dt>adapt</dt><dd><p>A number of iterations used for MCMC adaptation. Defaults
to <code>1000</code>.</p></dd>
<dt>bridge_max_iter</dt><dd><p>Maximum number of iterations for the
<a href='https://rdrr.io/pkg/bridgesampling/man/bridge_sampler.html'>bridge_sampler</a> function. Defaults to <code>10000</code></p></dd>
<dt>allow_max_error</dt><dd><p>Maximum allowed MCMC error for a model to be taken
into consideration. The model will be removed from the ensemble if it fails to
achieve the set MCMC error. Defaults to <code>NULL</code> - no model will be
removed based on MCMC error.</p></dd>
<dt>allow_max_rhat</dt><dd><p>Maximum allowed Rhat for a model to be taken into
consideration. Model will be removed from the ensemble if it fails to
achieve the set Rhat. Defaults to <code>NULL</code> - no model will be removed
based on Rhat.</p></dd>
<dt>allow_min_ESS</dt><dd><p>Minimum allowed ESS for a model to be taken into
consideration. Model will be removed from the ensemble if it fails to
achieve the set ESS. Defaults to <code>NULL</code> - no model will be removed
based on ESS.</p></dd>
<dt>balance_prob</dt><dd><p>Whether the prior probability of the removed model
should be redistributed to other models with the same type if possible
(crossing of effect / heterogeneity / publication bias). Defaults to
<code>TRUE</code>.</p></dd>
<dt>silent</dt><dd><p>Whether all fitting messages should be suppressed. Defaults
to <code>FALSE</code>. Ideal for getting rid of the "full precision may not have
been achieved in pntfinal'" warning that cannot be suppressed in any
other way.</p></dd>
<dt>boost</dt><dd><p>Whether the likelihood functions implemented using the boost
C++ library should be used as the first option. The higher precision of
boost allows to estimate models in difficult cases. Defaults to <code>FALSE</code>.
The R distributions are used as default and boost is used only if they fail.
Warning: the estimation using boost takes about twice as long.</p></dd>
<dt>cores</dt><dd><p>Number of cores to bu used fo parallel computation. If
<code>parallel == TRUE</code>, the default number is equal to number of cores - 1,
and 1 (no parallel processing otherwise).</p></dd>

</dl></td>
    </tr>
    <tr>
      <th>chains</th>
      <td><p>a number of chains of the MCMC algorithm.</p></td>
    </tr>
    <tr>
      <th>iter</th>
      <td><p>a number of sampling iterations of the MCMC algorithm.
Defaults to <code>10000</code>, with a minimum of <code>4000</code>.</p></td>
    </tr>
    <tr>
      <th>burnin</th>
      <td><p>a number of burnin iterations of the MCMC algorithm.
Defaults to <code>5000</code>.</p></td>
    </tr>
    <tr>
      <th>thin</th>
      <td><p>a thinning of the chains of the MCMC algorithm. Defaults to
<code>1</code>.</p></td>
    </tr>
    <tr>
      <th>parallel</th>
      <td><p>whether the individual models should be fitted in parallel.
Defaults to <code>FALSE</code>. The <code>cores</code> argument within the <code>control</code>
list will overwrite the setting if specified to a number higher than 1.</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p>a seed to be set before model fitting, marginal likelihood
computation, and posterior mixing for exact results reproducibility. Defaults
to <code>NULL</code> - no seed is set.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>RoBMA</code> returns an object of <a href='https://rdrr.io/r/base/class.html'>class</a> <code>"RoBMA"</code>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>See <code><a href='RoBMA.html'>RoBMA()</a></code> for more details.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='RoBMA.html'>RoBMA()</a></code>, <code><a href='summary.RoBMA.html'>summary.RoBMA()</a></code>, <code><a href='prior.html'>prior()</a></code>, <code><a href='check_setup.html'>check_setup()</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='co'># using the example data from Anderson et al. 2010 and fitting the default model</span>
<span class='co'># (note that the model can take a while to fit)</span>
<span class='va'>fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='RoBMA.html'>RoBMA</a></span><span class='op'>(</span>r <span class='op'>=</span> <span class='va'>Anderson2010</span><span class='op'>$</span><span class='va'>r</span>, n <span class='op'>=</span> <span class='va'>Anderson2010</span><span class='op'>$</span><span class='va'>n</span>, study_names <span class='op'>=</span> <span class='va'>Anderson2010</span><span class='op'>$</span><span class='va'>labels</span><span class='op'>)</span>

<span class='co'># the update function allows us to change the prior model probability of each model</span>
<span class='va'>fit1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/update.html'>update</a></span><span class='op'>(</span><span class='va'>fit</span>, prior_odds <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># add an additional model with different priors specification (see '?prior' for more information)</span>
<span class='va'>fit2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/update.html'>update</a></span><span class='op'>(</span><span class='va'>fit</span>,
               priors_mu_null <span class='op'>=</span> <span class='fu'><a href='prior.html'>prior</a></span><span class='op'>(</span><span class='st'>"point"</span>, parameters <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>location <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>,
               priors_tau <span class='op'>=</span> <span class='fu'><a href='prior.html'>prior</a></span><span class='op'>(</span><span class='st'>"normal"</span>,
                                  parameters <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>mean <span class='op'>=</span> <span class='fl'>0</span>, sd <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>,
                                  truncation <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>lower <span class='op'>=</span> <span class='fl'>0</span>, upper <span class='op'>=</span> <span class='cn'>Inf</span><span class='op'>)</span><span class='op'>)</span>,
               priors_omega <span class='op'>=</span> <span class='fu'><a href='prior.html'>prior</a></span><span class='op'>(</span><span class='st'>"one-sided"</span>,
                                    parameters <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>cuts <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>.05</span><span class='op'>)</span>, alpha <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># change the model convergence criteria to mark models with ESS lower than 2000 as non-covergent</span>
<span class='va'>fit3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/update.html'>update</a></span><span class='op'>(</span><span class='va'>fit</span>, control <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>allow_min_ESS <span class='op'>=</span> <span class='fl'>2000</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># and refit them failed models with increased number of burnin iterations</span>
<span class='va'>fit4</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/update.html'>update</a></span><span class='op'>(</span><span class='va'>fit3</span>, burnin <span class='op'>=</span> <span class='fl'>10000</span><span class='op'>)</span>

<span class='op'>}</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by František Bartoš, Maximilian Maier.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


