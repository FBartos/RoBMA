<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Z-Curve Publication Bias Diagnostics • RoBMA</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Z-Curve Publication Bias Diagnostics">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RoBMA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.6.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/CustomEnsembles.html">Fitting Custom Meta-Analytic Ensembles</a></li>
    <li><a class="dropdown-item" href="../articles/FastRoBMA.html">Fast Robust Bayesian Meta-Analysis via Spike and Slab Algorithm</a></li>
    <li><a class="dropdown-item" href="../articles/HierarchicalBMA.html">Hierarchical Bayesian Model-Averaged Meta-Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/MedicineBiBMA.html">Informed Bayesian Model-Averaged Meta-Analysis with Binary Outcomes</a></li>
    <li><a class="dropdown-item" href="../articles/MedicineBMA.html">Informed Bayesian Model-Averaged Meta-Analysis in Medicine</a></li>
    <li><a class="dropdown-item" href="../articles/MetaRegression.html">Robust Bayesian Model-Averaged Meta-Regression</a></li>
    <li><a class="dropdown-item" href="../articles/ReproducingBMA.html">Reproducing Bayesian Model-Averaged Meta-Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/Tutorial.html">Tutorial: Adjusting for Publication Bias in JASP and R - Selection Models, PET-PEESE, and Robust Bayesian Meta-Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/ZCurveDiagnostics.html">Z-Curve Publication Bias Diagnostics</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/FBartos/RoBMA/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Z-Curve Publication Bias Diagnostics</h1>
                        <h4 data-toc-skip class="author">František
Bartoš</h4>
            
            <h4 data-toc-skip class="date">2025-09-10</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/FBartos/RoBMA/blob/v3.6.0/vignettes/ZCurveDiagnostics.Rmd" class="external-link"><code>vignettes/ZCurveDiagnostics.Rmd</code></a></small>
      <div class="d-none name"><code>ZCurveDiagnostics.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><strong>This vignette accompanies the “Z-Curve Plot: A Visual
Diagnostic for Publication Bias in Meta-Analysis” manuscript <span class="citation">(Bartoš &amp; Schimmack, 2025)</span>. The manuscript
provides the theoretical foundation and detailed methodology for z-curve
diagnostics, while this vignette demonstrates their practical
implementation using the RoBMA R package <span class="citation">(Bartoš
&amp; Maier, 2020)</span>.</strong></p>
<p>Z-curve plots provide a visual assessment of meta-analytic model fit
specifically aimed at detecting misfit due to publication bias <span class="citation">(Bartoš &amp; Schimmack, 2025)</span>. The methodology
overlays model-implied posterior predictive distributions of
z-statistics on the observed distribution of z-statistics <span class="citation">(Gabry et al., 2019)</span>, allowing researchers to
assess how well different meta-analytic models capture the patterns in
their data. The approach builds on the z-curve methodology developed by
<span class="citation">Brunner &amp; Schimmack (2020)</span> for
assessing the quality of research.</p>
<p>The z-curve approach complements statistical tests of publication
bias (such as inclusion Bayes factors) with intuitive visualizations
that can highlight model misfit due to publication bias. Additionally,
the method allows extrapolation to the pre-publication bias state,
providing estimates of key metrics such as the expected discovery rate
and the number of missing studies.</p>
<p>We illustrate the z-curve diagnostics using four empirical examples
from recent meta-analyses that exhibit different degrees of publication
bias. The examples demonstrate how to interpret z-curve plots and use
them to guide model selection in meta-analytic practice. For details
refer to the accompanying manuscript <span class="citation">(Bartoš
&amp; Schimmack, 2025)</span>.</p>
</div>
<div class="section level2">
<h2 id="getting-started">Getting Started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<p>Before we start, we load the RoBMA package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://fbartos.github.io/RoBMA/" class="external-link">"RoBMA"</a></span><span class="op">)</span></span></code></pre></div>
<p>The z-curve diagnostic workflow consists of the following steps:</p>
<ol style="list-style-type: decimal">
<li>Fit meta-analytic models to your data using <code><a href="../reference/NoBMA.html">NoBMA()</a></code> for
random-effects models or <code><a href="../reference/RoBMA.html">RoBMA()</a></code> for publication
bias-adjusted models <span class="citation">(Bartoš et al., 2023; Maier
et al., 2023)</span>.</li>
<li>Create z-curve objects using the <code><a href="../reference/as_zcurve.html">as_zcurve()</a></code>
function.</li>
<li>Generate histograms of observed z-statistics using
<code><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist()</a></code> .</li>
<li>Overlay model fits using <code><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines()</a></code> to compare different
models.</li>
<li>Use the visualization to supplement statistical model
comparison.</li>
</ol>
<p>Note that when using <code><a href="../reference/NoBMA.html">NoBMA()</a></code> to fit a standard
random-effects model we need to set
<code>priors_effect_null = NULL</code> and
<code>priors_heterogeneity_null = NULL</code> to disable model averaging
across null hypotheses. This ensures we fit a single random-effects
model rather than a Bayesian model-averaged ensemble. The z-curve plot
is implemented only for models fitted using the spike-and-slab algorithm
specified via <code>algorithm = "ss"</code>.</p>
</div>
<div class="section level2">
<h2 id="applied-examples">Applied Examples<a class="anchor" aria-label="anchor" href="#applied-examples"></a>
</h2>
<p>We demonstrate the z-curve diagnostics on four empirical
meta-analyses that represent different publication bias scenarios:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Ease-of-retrieval effect in the few/many paradigm</strong>
<span class="citation">(Weingarten &amp; Hutchinson, 2018)</span> - An
example with extreme publication bias</li>
<li>
<strong>Social comparison as behavior change technique</strong>
<span class="citation">(Hoppen et al., 2025)</span> - An example with
strong publication bias</li>
<li>
<strong>ChatGPT effects on learning performance</strong> <span class="citation">(Wang &amp; Fan, 2025)</span> - An example with
moderate publication bias<br>
</li>
<li>
<strong>Framing effects from Many Labs 2</strong> <span class="citation">(Klein et al., 2018)</span> - An example with no
publication bias (registered replication reports)</li>
</ol>
<p>For each example, we fit both a simple random-effects model using
<code><a href="../reference/NoBMA.html">NoBMA()</a></code> and a publication bias-adjusted ensemble using
<code><a href="../reference/RoBMA.html">RoBMA()</a></code> <span class="citation">(Bartoš et al., 2023; Maier
et al., 2023)</span>. We then use z-curve plots to compare how well each
model captures the observed distribution of z-statistics.</p>
<div class="section level3">
<h3 id="example-1-ease-of-retrieval-effect-in-the-fewmany-paradigm">Example 1: Ease-of-Retrieval Effect in the Few/Many Paradigm<a class="anchor" aria-label="anchor" href="#example-1-ease-of-retrieval-effect-in-the-fewmany-paradigm"></a>
</h3>
<p>This example examines the ease-of-retrieval effect, a
well-established phenomenon in cognitive psychology where the subjective
difficulty of recalling information influences judgments more than the
actual number of items recalled <span class="citation">(<strong>schwarz1991ease?</strong>)</span>.</p>
<p>We analyze 298 estimates from 111 studies examining the
ease-of-retrieval effect in the few/many standard paradigm in the
proximal dataset collected by Weingarten and colleagues <span class="citation">(Weingarten &amp; Hutchinson, 2018)</span>. The
original analysis reported a pooled effect size r = 0.25, 95% CI [0.22,
0.28]. When adjusted for publication bias using PET-PEESE, the effect
was reduced but remained substantial at r = 0.19, 95% CI [0.15,
0.23].</p>
<div class="section level4">
<h4 id="data-and-model-fitting">Data and Model Fitting<a class="anchor" aria-label="anchor" href="#data-and-model-fitting"></a>
</h4>
<p>We begin by loading the ease-of-retrieval dataset and examining its
structure. We focus on studies using the standard paradigm in proximal
dataset conditions:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the ease-of-retrieval dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Weingarten2018"</span>, package <span class="op">=</span> <span class="st">"RoBMA"</span><span class="op">)</span></span>
<span><span class="co"># Filter to standard paradigm and proximal dataset as in the original analysis</span></span>
<span><span class="va">Weingarten2018</span> <span class="op">&lt;-</span> <span class="va">Weingarten2018</span><span class="op">[</span><span class="va">Weingarten2018</span><span class="op">$</span><span class="va">standard_paradigm</span> <span class="op">&amp;</span> <span class="va">Weingarten2018</span><span class="op">$</span><span class="va">proximal_dataset</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Weingarten2018</span><span class="op">)</span></span>
<span><span class="co">#&gt;          r_xy    N paper_id published   USA number_of_few number_of_many</span></span>
<span><span class="co">#&gt; 129 0.2921094 20.0        1      TRUE FALSE             6             12</span></span>
<span><span class="co">#&gt; 130 0.2675424 20.0        1      TRUE FALSE             6             12</span></span>
<span><span class="co">#&gt; 131 0.1741571 79.0        1      TRUE FALSE             6             12</span></span>
<span><span class="co">#&gt; 132 0.2076078 79.0        1      TRUE FALSE             6             12</span></span>
<span><span class="co">#&gt; 135 0.3333333 19.5        1      TRUE FALSE             6             12</span></span>
<span><span class="co">#&gt; 136 0.3855344 19.5        1      TRUE FALSE             6             12</span></span>
<span><span class="co">#&gt;     episodic_memory standard_paradigm proximal_dataset      r_xm  r_my</span></span>
<span><span class="co">#&gt; 129            TRUE              TRUE             TRUE 0.3232300  0.35</span></span>
<span><span class="co">#&gt; 130            TRUE              TRUE             TRUE 0.3232300  0.66</span></span>
<span><span class="co">#&gt; 131            TRUE              TRUE             TRUE 0.1879524  0.12</span></span>
<span><span class="co">#&gt; 132            TRUE              TRUE             TRUE 0.1879524  0.32</span></span>
<span><span class="co">#&gt; 135            TRUE              TRUE             TRUE 0.1566084 -0.03</span></span>
<span><span class="co">#&gt; 136            TRUE              TRUE             TRUE 0.1566084  0.23</span></span></code></pre></div>
<p>The filtered dataset contains 298 effect size estimates (correlation
coefficients) and sample sizes. Since the effect size estimates are
nested within studies (indicated by the <code>paper_id</code> variable),
we specify a multilevel random-effects model using <code><a href="../reference/NoBMA.html">NoBMA()</a></code>
and a multilevel publication bias-adjusted model using
<code><a href="../reference/RoBMA.html">RoBMA()</a></code> <span class="citation">(Bartoš et al.,
2025)</span>. (Note that RoBMA internally transforms the correlation
coefficients to Fisher’s z for analysis.)</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit random-effects model (unadjusted for publication bias)</span></span>
<span><span class="va">fit_RE_Weingarten2018</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/NoBMA.html">NoBMA</a></span><span class="op">(</span>r <span class="op">=</span> <span class="va">Weingarten2018</span><span class="op">$</span><span class="va">r_xy</span>, n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">Weingarten2018</span><span class="op">$</span><span class="va">N</span><span class="op">)</span>, </span>
<span>                               study_ids <span class="op">=</span> <span class="va">Weingarten2018</span><span class="op">$</span><span class="va">paper_id</span>,</span>
<span>                               priors_effect_null <span class="op">=</span> <span class="cn">NULL</span>, priors_heterogeneity_null <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                               algorithm <span class="op">=</span> <span class="st">"ss"</span>, sample <span class="op">=</span> <span class="fl">10000</span>, burnin <span class="op">=</span> <span class="fl">10000</span>, adapt <span class="op">=</span> <span class="fl">10000</span>, </span>
<span>                               chains <span class="op">=</span> <span class="fl">5</span>, parallel <span class="op">=</span> <span class="cn">TRUE</span>, seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit RoBMA model (adjusted for publication bias)</span></span>
<span><span class="va">fit_RoBMA_Weingarten2018</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RoBMA.html">RoBMA</a></span><span class="op">(</span>r <span class="op">=</span> <span class="va">Weingarten2018</span><span class="op">$</span><span class="va">r_xy</span>, n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">Weingarten2018</span><span class="op">$</span><span class="va">N</span><span class="op">)</span>, </span>
<span>                                  study_ids <span class="op">=</span> <span class="va">Weingarten2018</span><span class="op">$</span><span class="va">paper_id</span>,</span>
<span>                                  algorithm <span class="op">=</span> <span class="st">"ss"</span>, sample <span class="op">=</span> <span class="fl">10000</span>, burnin <span class="op">=</span> <span class="fl">10000</span>, adapt <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>                                  chains <span class="op">=</span> <span class="fl">5</span>, parallel <span class="op">=</span> <span class="cn">TRUE</span>, seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="model-results-summary">Model Results Summary<a class="anchor" aria-label="anchor" href="#model-results-summary"></a>
</h4>
<p>We can examine the results from both models using the
<code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Random-effects model results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_RE_Weingarten2018</span>, output_scale <span class="op">=</span> <span class="st">"r"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; RoBMA(d = d, r = r, logOR = logOR, OR = OR, z = z, y = y, se = se, </span></span>
<span><span class="co">#&gt;     v = v, n = n, lCI = lCI, uCI = uCI, t = t, study_names = study_names, </span></span>
<span><span class="co">#&gt;     study_ids = study_ids, data = data, transformation = transformation, </span></span>
<span><span class="co">#&gt;     prior_scale = prior_scale, effect_direction = "positive", </span></span>
<span><span class="co">#&gt;     model_type = model_type, priors_effect = priors_effect, priors_heterogeneity = priors_heterogeneity, </span></span>
<span><span class="co">#&gt;     priors_bias = NULL, priors_effect_null = priors_effect_null, </span></span>
<span><span class="co">#&gt;     priors_heterogeneity_null = priors_heterogeneity_null, priors_bias_null = prior_none(), </span></span>
<span><span class="co">#&gt;     priors_hierarchical = priors_hierarchical, priors_hierarchical_null = priors_hierarchical_null, </span></span>
<span><span class="co">#&gt;     algorithm = algorithm, chains = chains, sample = sample, </span></span>
<span><span class="co">#&gt;     burnin = burnin, adapt = adapt, thin = thin, parallel = parallel, </span></span>
<span><span class="co">#&gt;     autofit = autofit, autofit_control = autofit_control, convergence_checks = convergence_checks, </span></span>
<span><span class="co">#&gt;     save = save, seed = seed, silent = silent)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Bayesian model-averaged meta-analysis (normal-normal model)</span></span>
<span><span class="co">#&gt; Components summary:</span></span>
<span><span class="co">#&gt;               Prior prob. Post. prob. Inclusion BF</span></span>
<span><span class="co">#&gt; Effect              1.000       1.000          Inf</span></span>
<span><span class="co">#&gt; Heterogeneity       1.000       1.000          Inf</span></span>
<span><span class="co">#&gt; Hierarchical        1.000       1.000          Inf</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model-averaged estimates:</span></span>
<span><span class="co">#&gt;      Mean Median 0.025 0.975</span></span>
<span><span class="co">#&gt; mu  0.246  0.246 0.220 0.273</span></span>
<span><span class="co">#&gt; tau 0.120  0.120 0.097 0.148</span></span>
<span><span class="co">#&gt; rho 0.946  0.955 0.844 0.997</span></span>
<span><span class="co">#&gt; The effect size estimates are summarized on the correlation scale and heterogeneity is summarized on the Fisher's z scale (priors were specified on the Cohen's d scale).</span></span>
<span><span class="co">#&gt; (Estimated publication weights omega correspond to one-sided p-values.)</span></span>
<span></span>
<span><span class="co"># RoBMA model results  </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_RoBMA_Weingarten2018</span>, output_scale <span class="op">=</span> <span class="st">"r"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; RoBMA(r = Weingarten2018$r_xy, n = round(Weingarten2018$N), study_ids = Weingarten2018$paper_id, </span></span>
<span><span class="co">#&gt;     algorithm = "ss", chains = 5, sample = 10000, burnin = 10000, </span></span>
<span><span class="co">#&gt;     adapt = 10000, parallel = TRUE, save = "min", seed = 1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Robust Bayesian meta-analysis</span></span>
<span><span class="co">#&gt; Components summary:</span></span>
<span><span class="co">#&gt;               Prior prob. Post. prob. Inclusion BF</span></span>
<span><span class="co">#&gt; Effect              0.500       1.000          Inf</span></span>
<span><span class="co">#&gt; Heterogeneity       0.500       1.000          Inf</span></span>
<span><span class="co">#&gt; Bias                0.500       1.000          Inf</span></span>
<span><span class="co">#&gt; Hierarchical        1.000       1.000          Inf</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model-averaged estimates:</span></span>
<span><span class="co">#&gt;                    Mean Median 0.025 0.975</span></span>
<span><span class="co">#&gt; mu                0.170  0.170 0.131 0.208</span></span>
<span><span class="co">#&gt; tau               0.128  0.128 0.100 0.160</span></span>
<span><span class="co">#&gt; rho               0.959  0.967 0.877 0.998</span></span>
<span><span class="co">#&gt; omega[0,0.025]    1.000  1.000 1.000 1.000</span></span>
<span><span class="co">#&gt; omega[0.025,0.05] 0.882  0.927 0.587 1.000</span></span>
<span><span class="co">#&gt; omega[0.05,0.5]   0.273  0.268 0.169 0.409</span></span>
<span><span class="co">#&gt; omega[0.5,0.95]   0.099  0.091 0.038 0.207</span></span>
<span><span class="co">#&gt; omega[0.95,0.975] 0.099  0.091 0.038 0.207</span></span>
<span><span class="co">#&gt; omega[0.975,1]    0.099  0.091 0.038 0.207</span></span>
<span><span class="co">#&gt; PET               0.000  0.000 0.000 0.000</span></span>
<span><span class="co">#&gt; PEESE             0.000  0.000 0.000 0.000</span></span>
<span><span class="co">#&gt; The effect size estimates are summarized on the correlation scale and heterogeneity is summarized on the Fisher's z scale (priors were specified on the Cohen's d scale).</span></span>
<span><span class="co">#&gt; (Estimated publication weights omega correspond to one-sided p-values.)</span></span></code></pre></div>
<p>The Bayesian multilevel random-effects model finds results similar to
those reported in the original publication-bias-unadjusted analysis.</p>
<p>The RoBMA analysis reveals extreme evidence for publication bias.
However, RoBMA still finds extreme evidence for the presence of an
effect, with a model-averaged effect size estimate of g = 0.17, 95% CI
[0.13, 0.21].</p>
</div>
<div class="section level4">
<h4 id="creating-z-curve-objects">Creating Z-Curve Objects<a class="anchor" aria-label="anchor" href="#creating-z-curve-objects"></a>
</h4>
<p>The <code><a href="../reference/as_zcurve.html">as_zcurve()</a></code> function converts fitted RoBMA models
into objects suitable for z-curve visualization:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create z-curve objects</span></span>
<span><span class="va">zcurve_RE_Weingarten2018</span>    <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_zcurve.html">as_zcurve</a></span><span class="op">(</span><span class="va">fit_RE_Weingarten2018</span><span class="op">)</span></span>
<span><span class="va">zcurve_RoBMA_Weingarten2018</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_zcurve.html">as_zcurve</a></span><span class="op">(</span><span class="va">fit_RoBMA_Weingarten2018</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="z-curve-diagnostic-plots">Z-Curve Diagnostic Plots<a class="anchor" aria-label="anchor" href="#z-curve-diagnostic-plots"></a>
</h4>
<p>We now generate z-curve plots to assess how well each model captures
the observed distribution of z-statistics. The <code><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist()</a></code>
function creates a histogram of the observed z-statistics, while
<code><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines()</a></code> overlays the model-implied posterior predictive
distributions <span class="citation">(Gabry et al., 2019)</span>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create histogram of observed z-statistics</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">zcurve_RoBMA_Weingarten2018</span>, from <span class="op">=</span> <span class="op">-</span><span class="fl">3</span>, to <span class="op">=</span> <span class="fl">6</span>, by <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add model-implied distributions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">zcurve_RE_Weingarten2018</span>, from <span class="op">=</span> <span class="op">-</span><span class="fl">3</span>, to <span class="op">=</span> <span class="fl">6</span>, col <span class="op">=</span> <span class="st">"black"</span>, lty <span class="op">=</span> <span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">zcurve_RoBMA_Weingarten2018</span>, from <span class="op">=</span> <span class="op">-</span><span class="fl">3</span>, to <span class="op">=</span> <span class="fl">6</span>, col <span class="op">=</span> <span class="st">"blue"</span>, lty <span class="op">=</span> <span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add legend</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, </span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Random-Effects"</span>, <span class="st">"RoBMA"</span><span class="op">)</span>, </span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"blue"</span><span class="op">)</span>, </span>
<span>       lty <span class="op">=</span> <span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="ZCurveDiagnostics_files/figure-html/unnamed-chunk-8-1.png" alt="Ease-of-Retrieval Effect: Model Fit Assessment" width="672"><p class="caption">
Ease-of-Retrieval Effect: Model Fit Assessment
</p>
</div>
<p>The z-curve plot reveals clear evidence of extreme publication bias
in the ease-of-retrieval literature. Two extreme discontinuities are
visible in the observed distribution of z-statistics (gray bars):</p>
<ol style="list-style-type: decimal">
<li><p><strong>Marginal Significance Threshold (z ≈ 1.64)</strong>:
There is a sharp increase in the frequency of test statistics just above
the threshold for marginal significance (α = 0.10).</p></li>
<li><p><strong>Zero Threshold (z = 0)</strong>: A weaker discontinuity
occurs at zero, with additional suppression of studies reporting
negative effects (z &lt; 0).</p></li>
</ol>
<p>The random-effects model (black dashed line) fails to capture these
patterns. It systematically overestimates the number of negative results
and non-significant positive results.</p>
<p>RoBMA (blue dashed line) captures both discontinuities and
approximates the observed data much better. These results provide
extreme evidence for the presence of publication bias and highlight the
need to interpret the publication bias-adjusted model.</p>
</div>
<div class="section level4">
<h4 id="extrapolation-to-pre-publication-bias">Extrapolation to Pre-Publication Bias<a class="anchor" aria-label="anchor" href="#extrapolation-to-pre-publication-bias"></a>
</h4>
<p>The package also allows us to extrapolate what the distribution of
z-statistics might have looked like in the absence of publication bias.
This is achieved by calling the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function (with the
default <code>plot_extrapolation = TRUE</code> argument).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot extrapolation to pre-publication bias</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">zcurve_RoBMA_Weingarten2018</span>, from <span class="op">=</span> <span class="op">-</span><span class="fl">3</span>, to <span class="op">=</span> <span class="fl">6</span>, by.hist <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="ZCurveDiagnostics_files/figure-html/unnamed-chunk-9-1.png" alt="Ease-of-Retrieval Effect: Extrapolation Analysis" width="672"><p class="caption">
Ease-of-Retrieval Effect: Extrapolation Analysis
</p>
</div>
<p>The extrapolated distribution (blue line) shows what we would expect
to observe if studies were published regardless of their results.
Comparing the fitted distribution (accounting for publication bias) with
the extrapolated distribution reveals the extent of the bias. The large
discrepancy between these distributions quantifies the substantial
impact of publication bias in this literature.</p>
</div>
<div class="section level4">
<h4 id="z-curve-summary-metrics">Z-Curve Summary Metrics<a class="anchor" aria-label="anchor" href="#z-curve-summary-metrics"></a>
</h4>
<p>This discrepancy can be summarized with the additional statistics
provided by the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract z-curve summary metrics</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">zcurve_RoBMA_Weingarten2018</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; as_zcurve: RoBMA(r = Weingarten2018$r_xy, n = round(Weingarten2018$N), study_ids = Weingarten2018$paper_id, </span></span>
<span><span class="co">#&gt;     algorithm = "ss", chains = 5, sample = 10000, burnin = 10000, </span></span>
<span><span class="co">#&gt;     adapt = 10000, parallel = TRUE, save = "min", seed = 1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Z-curve</span></span>
<span><span class="co">#&gt; Model-averaged estimates:</span></span>
<span><span class="co">#&gt;              Mean  Median   0.025    0.975</span></span>
<span><span class="co">#&gt; EDR         0.187   0.184   0.144    0.236</span></span>
<span><span class="co">#&gt; Soric FDR   0.234   0.233   0.170    0.312</span></span>
<span><span class="co">#&gt; Missing N 561.951 525.437 277.430 1068.835</span></span>
<span><span class="co">#&gt; Estimated using 298 estimates, 134 significant (ODR = 0.45, 95 CI [0.39, 0.51]).</span></span></code></pre></div>
<p>The summary provides several key results: The observed discovery rate
(ODR = 0.45) substantially exceeds the expected discovery rate (EDR =
0.18, 95% CI [0.14, 0.23]), indicating that roughly 2.5 times as many
significant results appear in the published literature as we would
expect. The estimated number of missing studies, 579 (95% CI [311,
1014]), suggests that a substantial number of non-significant or
negative results may be absent from the published literature. The false
discovery risk (FDR = 0.24, 95% CI [0.18, 0.31]) provides an upper bound
on the proportion of statistically significant results that may be false
positives, though this risk remains moderate due to evidence for a
genuine underlying effect despite the extreme publication bias.</p>
</div>
</div>
<div class="section level3">
<h3 id="example-2-social-comparison-and-behavior-change">Example 2: Social Comparison and Behavior Change<a class="anchor" aria-label="anchor" href="#example-2-social-comparison-and-behavior-change"></a>
</h3>
<p>This example examines a meta-analysis of randomized controlled trials
evaluating the efficacy of social comparison as a behavior change
technique <span class="citation">(Hoppen et al., 2025)</span>. The
analysis includes 37 trials comparing social comparison interventions to
passive controls across domains including climate-change mitigation,
health, performance, and service outcomes.</p>
<div class="section level4">
<h4 id="data-and-model-fitting-1">Data and Model Fitting<a class="anchor" aria-label="anchor" href="#data-and-model-fitting-1"></a>
</h4>
<p>Again, we begin by loading the social comparison dataset and
examining its structure:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the social comparison dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Hoppen2025"</span>, package <span class="op">=</span> <span class="st">"RoBMA"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Hoppen2025</span><span class="op">)</span></span>
<span><span class="co">#&gt;           d            v        outcome feedback_level  social_comparison_type</span></span>
<span><span class="co">#&gt; 1 0.2206399 3.043547e-02    performance     individual             performance</span></span>
<span><span class="co">#&gt; 2 0.1284494 5.946958e-03 sustainability          group          sustainability</span></span>
<span><span class="co">#&gt; 3 0.1187558 7.707186e-04 sustainability          group          sustainability</span></span>
<span><span class="co">#&gt; 4 0.4400000 6.968339e-05    performance          group                  safety</span></span>
<span><span class="co">#&gt; 5 0.4198868 4.756183e-02 sustainability          group monetary/sustainability</span></span>
<span><span class="co">#&gt; 6 0.0861236 2.219765e-02 sustainability          group          sustainability</span></span>
<span><span class="co">#&gt;   sessions      sample_type sample_size country</span></span>
<span><span class="co">#&gt; 1        2            other         179  Canada</span></span>
<span><span class="co">#&gt; 2        1 population-based        1035     USA</span></span>
<span><span class="co">#&gt; 3        2 population-based       21151     USA</span></span>
<span><span class="co">#&gt; 4        1 population-based      395204   China</span></span>
<span><span class="co">#&gt; 5        4          student         553  Taiwan</span></span>
<span><span class="co">#&gt; 6       NA population-based         390     USA</span></span></code></pre></div>
<p>The dataset contains effect sizes (<code>d</code>) and sampling
variances (<code>v</code>) from individual studies. We fit both a
random-effects model using <code><a href="../reference/NoBMA.html">NoBMA()</a></code> and a publication
bias-adjusted model using <code><a href="../reference/RoBMA.html">RoBMA()</a></code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit random-effects model (unadjusted for publication bias)</span></span>
<span><span class="va">fit_RE_Hoppen2025</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/NoBMA.html">NoBMA</a></span><span class="op">(</span>d <span class="op">=</span> <span class="va">Hoppen2025</span><span class="op">$</span><span class="va">d</span>, se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">Hoppen2025</span><span class="op">$</span><span class="va">v</span><span class="op">)</span>, </span>
<span>                           priors_effect_null <span class="op">=</span> <span class="cn">NULL</span>, priors_heterogeneity_null <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                           algorithm <span class="op">=</span> <span class="st">"ss"</span>, sample <span class="op">=</span> <span class="fl">10000</span>, burnin <span class="op">=</span> <span class="fl">5000</span>, adapt <span class="op">=</span> <span class="fl">5000</span>, </span>
<span>                           chains <span class="op">=</span> <span class="fl">5</span>, parallel <span class="op">=</span> <span class="cn">TRUE</span>, seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit RoBMA model (adjusted for publication bias)</span></span>
<span><span class="va">fit_RoBMA_Hoppen2025</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RoBMA.html">RoBMA</a></span><span class="op">(</span>d <span class="op">=</span> <span class="va">Hoppen2025</span><span class="op">$</span><span class="va">d</span>, se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">Hoppen2025</span><span class="op">$</span><span class="va">v</span><span class="op">)</span>, </span>
<span>                              algorithm <span class="op">=</span> <span class="st">"ss"</span>, sample <span class="op">=</span> <span class="fl">10000</span>, burnin <span class="op">=</span> <span class="fl">5000</span>, adapt <span class="op">=</span> <span class="fl">5000</span>, </span>
<span>                              chains <span class="op">=</span> <span class="fl">5</span>, parallel <span class="op">=</span> <span class="cn">TRUE</span>, seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="model-results-summary-1">Model Results Summary<a class="anchor" aria-label="anchor" href="#model-results-summary-1"></a>
</h4>
<p>We examine the key results from both models:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Random-effects model results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_RE_Hoppen2025</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; RoBMA(d = d, r = r, logOR = logOR, OR = OR, z = z, y = y, se = se, </span></span>
<span><span class="co">#&gt;     v = v, n = n, lCI = lCI, uCI = uCI, t = t, study_names = study_names, </span></span>
<span><span class="co">#&gt;     study_ids = study_ids, data = data, transformation = transformation, </span></span>
<span><span class="co">#&gt;     prior_scale = prior_scale, effect_direction = "positive", </span></span>
<span><span class="co">#&gt;     model_type = model_type, priors_effect = priors_effect, priors_heterogeneity = priors_heterogeneity, </span></span>
<span><span class="co">#&gt;     priors_bias = NULL, priors_effect_null = priors_effect_null, </span></span>
<span><span class="co">#&gt;     priors_heterogeneity_null = priors_heterogeneity_null, priors_bias_null = prior_none(), </span></span>
<span><span class="co">#&gt;     priors_hierarchical = priors_hierarchical, priors_hierarchical_null = priors_hierarchical_null, </span></span>
<span><span class="co">#&gt;     algorithm = algorithm, chains = chains, sample = sample, </span></span>
<span><span class="co">#&gt;     burnin = burnin, adapt = adapt, thin = thin, parallel = parallel, </span></span>
<span><span class="co">#&gt;     autofit = autofit, autofit_control = autofit_control, convergence_checks = convergence_checks, </span></span>
<span><span class="co">#&gt;     save = save, seed = seed, silent = silent)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Bayesian model-averaged meta-analysis (normal-normal model)</span></span>
<span><span class="co">#&gt; Components summary:</span></span>
<span><span class="co">#&gt;               Prior prob. Post. prob. Inclusion BF</span></span>
<span><span class="co">#&gt; Effect              1.000       1.000          Inf</span></span>
<span><span class="co">#&gt; Heterogeneity       1.000       1.000          Inf</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model-averaged estimates:</span></span>
<span><span class="co">#&gt;      Mean Median 0.025 0.975</span></span>
<span><span class="co">#&gt; mu  0.169  0.168 0.106 0.234</span></span>
<span><span class="co">#&gt; tau 0.145  0.142 0.097 0.211</span></span>
<span><span class="co">#&gt; The estimates are summarized on the Cohen's d scale (priors were specified on the Cohen's d scale).</span></span>
<span><span class="co">#&gt; (Estimated publication weights omega correspond to one-sided p-values.)</span></span></code></pre></div>
<p>The random-effects model estimates a positive effect size of g =
0.17, 95% CI [0.11, 0.23], suggesting a positive effect of social
comparison interventions. However, this analysis does not account for
potential publication bias.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># RoBMA model results  </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_RoBMA_Hoppen2025</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; RoBMA(d = Hoppen2025$d, se = sqrt(Hoppen2025$v), algorithm = "ss", </span></span>
<span><span class="co">#&gt;     chains = 5, sample = 10000, burnin = 5000, adapt = 5000, </span></span>
<span><span class="co">#&gt;     parallel = TRUE, save = "min", seed = 1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Robust Bayesian meta-analysis</span></span>
<span><span class="co">#&gt; Components summary:</span></span>
<span><span class="co">#&gt;               Prior prob. Post. prob. Inclusion BF</span></span>
<span><span class="co">#&gt; Effect              0.500       0.112        0.126</span></span>
<span><span class="co">#&gt; Heterogeneity       0.500       1.000          Inf</span></span>
<span><span class="co">#&gt; Bias                0.500       0.998      596.826</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model-averaged estimates:</span></span>
<span><span class="co">#&gt;                     Mean Median  0.025 0.975</span></span>
<span><span class="co">#&gt; mu                -0.007  0.000 -0.152 0.046</span></span>
<span><span class="co">#&gt; tau                0.199  0.194  0.134 0.294</span></span>
<span><span class="co">#&gt; omega[0,0.025]     1.000  1.000  1.000 1.000</span></span>
<span><span class="co">#&gt; omega[0.025,0.05]  0.944  1.000  0.634 1.000</span></span>
<span><span class="co">#&gt; omega[0.05,0.5]    0.676  0.681  0.325 0.983</span></span>
<span><span class="co">#&gt; omega[0.5,0.95]    0.078  0.061  0.011 0.208</span></span>
<span><span class="co">#&gt; omega[0.95,0.975]  0.078  0.061  0.011 0.208</span></span>
<span><span class="co">#&gt; omega[0.975,1]     0.078  0.061  0.011 0.208</span></span>
<span><span class="co">#&gt; PET                0.003  0.000  0.000 0.000</span></span>
<span><span class="co">#&gt; PEESE              0.005  0.000  0.000 0.000</span></span>
<span><span class="co">#&gt; The estimates are summarized on the Cohen's d scale (priors were specified on the Cohen's d scale).</span></span>
<span><span class="co">#&gt; (Estimated publication weights omega correspond to one-sided p-values.)</span></span></code></pre></div>
<p>When accounting for the possibility of publication bias with RoBMA,
we find extreme evidence for the presence of publication bias (BF_bias =
597). Consequently, the effect size shrinks to g = -0.01, 95% CI [-0.15,
0.05], with moderate evidence against the presence of an effect
(BF_effect = 0.13).</p>
</div>
<div class="section level4">
<h4 id="z-curve-diagnostic-plots-1">Z-Curve Diagnostic Plots<a class="anchor" aria-label="anchor" href="#z-curve-diagnostic-plots-1"></a>
</h4>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create z-curve objects</span></span>
<span><span class="va">zcurve_RE_Hoppen2025</span>    <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_zcurve.html">as_zcurve</a></span><span class="op">(</span><span class="va">fit_RE_Hoppen2025</span><span class="op">)</span></span>
<span><span class="va">zcurve_RoBMA_Hoppen2025</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_zcurve.html">as_zcurve</a></span><span class="op">(</span><span class="va">fit_RoBMA_Hoppen2025</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create histogram of observed z-statistics</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">zcurve_RoBMA_Hoppen2025</span><span class="op">)</span></span>
<span><span class="co">#&gt; 2 z-statistics are out of the plotting range</span></span>
<span></span>
<span><span class="co"># Add model-implied distributions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">zcurve_RE_Hoppen2025</span>, col <span class="op">=</span> <span class="st">"black"</span>, lty <span class="op">=</span> <span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">zcurve_RoBMA_Hoppen2025</span>, col <span class="op">=</span> <span class="st">"blue"</span>, lty <span class="op">=</span> <span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add legend</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, </span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Random-Effects"</span>, <span class="st">"RoBMA"</span><span class="op">)</span>, </span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"blue"</span><span class="op">)</span>, </span>
<span>       lty <span class="op">=</span> <span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="ZCurveDiagnostics_files/figure-html/unnamed-chunk-16-1.png" alt="Social Comparison: Model Fit Assessment" width="672"><p class="caption">
Social Comparison: Model Fit Assessment
</p>
</div>
<pre><code>   lty = 2, lwd = 2)</code></pre>
<pre><code>
#### Results

The z-curve plot highlights the clear evidence of publication bias in this dataset. 
We can observe pronounced discontinuities in the observed distribution (gray bars) at critical thresholds; 
particularly at the transition to marginal significance (z ≈ 1.64) and at zero (indicating selection against negative results).

The random-effects model (black dashed line) fails to capture these patterns, systematically overestimating the number of negative and non-significant results. 
In contrast, RoBMA (blue dashed line) successfully models both discontinuities, providing a markedly better fit to the observed data. 
This visual assessment aligns with the statistical evidence: RoBMA yields extreme evidence for publication bias and suggests that the unadjusted pooled effect is misleading.

#### Extrapolation to Pre-Publication Bias

The package also allows us to extrapolate what the distribution of z-statistics might have looked like in the absence of publication bias. 
This is achieved by either setting `extrapolate = TRUE` in the `lines()` functions, or calling the `plot()` function (with the default `plot_extrapolation = TRUE` argument).


``` r
# Plot extrapolation to pre-publication bias
plot(zcurve_RoBMA_Hoppen2025)
#&gt; 2 z-statistics are out of the plotting range</code></pre>
<div class="figure">
<img src="ZCurveDiagnostics_files/figure-html/unnamed-chunk-17-1.png" alt="Social Comparison: Extrapolation Analysis" width="672"><p class="caption">
Social Comparison: Extrapolation Analysis
</p>
</div>
<p>The extrapolated distribution (blue line) shows what we would expect
to observe if studies were published regardless of their results.
Comparing the fitted distribution (accounting for publication bias) with
the extrapolated distribution reveals the extent of the bias. The large
discrepancy between these distributions quantifies the substantial
impact of publication bias in this literature, with implications for the
estimated effect size and number of missing studies.</p>
</div>
<div class="section level4">
<h4 id="z-curve-summary-metrics-1">Z-Curve Summary Metrics<a class="anchor" aria-label="anchor" href="#z-curve-summary-metrics-1"></a>
</h4>
<p>This discrepancy can be summarized with the additional statistics
provided by the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract z-curve summary metrics</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">zcurve_RoBMA_Hoppen2025</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; as_zcurve: RoBMA(d = Hoppen2025$d, se = sqrt(Hoppen2025$v), algorithm = "ss", </span></span>
<span><span class="co">#&gt;     chains = 5, sample = 10000, burnin = 5000, adapt = 5000, </span></span>
<span><span class="co">#&gt;     parallel = TRUE, save = "min", seed = 1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Z-curve</span></span>
<span><span class="co">#&gt; Model-averaged estimates:</span></span>
<span><span class="co">#&gt;             Mean Median  0.025   0.975</span></span>
<span><span class="co">#&gt; EDR        0.323  0.315  0.228   0.452</span></span>
<span><span class="co">#&gt; Soric FDR  0.116  0.114  0.064   0.178</span></span>
<span><span class="co">#&gt; Missing N 54.641 47.793 25.075 121.530</span></span>
<span><span class="co">#&gt; Estimated using 37 estimates, 12 significant (ODR = 0.32, 95 CI [0.19, 0.50]).</span></span></code></pre></div>
<p>The summary provides several results: The observed discovery rate
(ODR, i.e., the observed proportion of statistically significant
results) in the dataset matches the expected discovery rate (EDR) due to
the one-sided selection for marginally significant results (instead of
statistically significant results). The estimated number of missing
studies, 54, suggests that a considerable number of non-significant or
negative results may be absent from the published literature. The false
discovery risk (FDR), which corresponds to the upper bound on the false
positive rate, is not extremely inflated due to the possible small
positive and negative effects under the moderate heterogeneity.</p>
</div>
</div>
<div class="section level3">
<h3 id="example-3-chatgpt-and-learning-performance">Example 3: ChatGPT and Learning Performance<a class="anchor" aria-label="anchor" href="#example-3-chatgpt-and-learning-performance"></a>
</h3>
<p>Our second example examines the effectiveness of ChatGPT-based
interventions on students’ learning performance <span class="citation">(Wang &amp; Fan, 2025)</span>. This meta-analysis
includes 42 randomized controlled trials comparing experimental groups
(using ChatGPT for tutoring or learning support) with control groups
(without ChatGPT) on learning outcomes such as exam scores and final
grades.</p>
<div class="section level4">
<h4 id="data-preparation-and-model-fitting">Data Preparation and Model Fitting<a class="anchor" aria-label="anchor" href="#data-preparation-and-model-fitting"></a>
</h4>
<p>We follow the same procedure as in the previous example:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the ChatGPT dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Wang2025"</span>, package <span class="op">=</span> <span class="st">"RoBMA"</span><span class="op">)</span></span>
<span><span class="co"># Select learning performance studies</span></span>
<span><span class="va">Wang2025</span> <span class="op">&lt;-</span> <span class="va">Wang2025</span><span class="op">[</span><span class="va">Wang2025</span><span class="op">$</span><span class="va">Learning_effect</span> <span class="op">==</span> <span class="st">"Learning performance"</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Wang2025</span><span class="op">)</span></span>
<span><span class="co">#&gt;        Learning_effect                  Author_year N_EG N_CG     g Grade_level</span></span>
<span><span class="co">#&gt; 1 Learning performance          Emran et al. (2024)   34   34 2.730     College</span></span>
<span><span class="co">#&gt; 2 Learning performance              Almohesh (2024)   75   75 1.117     Primary</span></span>
<span><span class="co">#&gt; 3 Learning performance Avello-Martnez et al. (2023)   20   21 0.062     College</span></span>
<span><span class="co">#&gt; 4 Learning performance      Boudouaia et al. (2024)   37   39 0.797     College</span></span>
<span><span class="co">#&gt; 5 Learning performance          Bai? et al. (2023a)   12   12 0.993     College</span></span>
<span><span class="co">#&gt; 6 Learning performance        Chen and Chang (2024)   31   30 1.235     College</span></span>
<span><span class="co">#&gt;                           Type_of_course Duration         Learning_model</span></span>
<span><span class="co">#&gt; 1 Language learning and academic writing  &gt;8 week Problem-based learning</span></span>
<span><span class="co">#&gt; 2    Skills and competencies development &lt;=1 week  Personalized learning</span></span>
<span><span class="co">#&gt; 3    Skills and competencies development &lt;=1 week  Personalized learning</span></span>
<span><span class="co">#&gt; 4 Language learning and academic writing  &gt;8 week    Reflective learning</span></span>
<span><span class="co">#&gt; 5               STEM and related courses &lt;=1 week Problem-based learning</span></span>
<span><span class="co">#&gt; 6               STEM and related courses 1-4 week                  Mixed</span></span>
<span><span class="co">#&gt;             Role_of_ChatGPT Area_of_ChatGPT_application        se</span></span>
<span><span class="co">#&gt; 1 Intelligent learning tool                    Tutoring 0.3370820</span></span>
<span><span class="co">#&gt; 2         Intelligent tutor                       Mixed 0.1755723</span></span>
<span><span class="co">#&gt; 3 Intelligent learning tool Personalized recommendation 0.3125155</span></span>
<span><span class="co">#&gt; 4         Intelligent tutor   Assessment and evaluation 0.2384262</span></span>
<span><span class="co">#&gt; 5 Intelligent learning tool                    Tutoring 0.4326770</span></span>
<span><span class="co">#&gt; 6 Intelligent learning tool                       Mixed 0.2794517</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit models</span></span>
<span><span class="va">fit_RE_Wang2025</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/NoBMA.html">NoBMA</a></span><span class="op">(</span>d <span class="op">=</span> <span class="va">Wang2025</span><span class="op">$</span><span class="va">g</span>, se <span class="op">=</span> <span class="va">Wang2025</span><span class="op">$</span><span class="va">se</span>, </span>
<span>                         priors_effect_null <span class="op">=</span> <span class="cn">NULL</span>, priors_heterogeneity_null <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                         algorithm <span class="op">=</span> <span class="st">"ss"</span>, sample <span class="op">=</span> <span class="fl">10000</span>, burnin <span class="op">=</span> <span class="fl">5000</span>, adapt <span class="op">=</span> <span class="fl">5000</span>, </span>
<span>                         chains <span class="op">=</span> <span class="fl">5</span>, parallel <span class="op">=</span> <span class="cn">TRUE</span>, seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">fit_RoBMA_Wang2025</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RoBMA.html">RoBMA</a></span><span class="op">(</span>d <span class="op">=</span> <span class="va">Wang2025</span><span class="op">$</span><span class="va">g</span>, se <span class="op">=</span> <span class="va">Wang2025</span><span class="op">$</span><span class="va">se</span>, </span>
<span>                            algorithm <span class="op">=</span> <span class="st">"ss"</span>, sample <span class="op">=</span> <span class="fl">10000</span>, burnin <span class="op">=</span> <span class="fl">5000</span>, adapt <span class="op">=</span> <span class="fl">5000</span>, </span>
<span>                            chains <span class="op">=</span> <span class="fl">5</span>, parallel <span class="op">=</span> <span class="cn">TRUE</span>, seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create z-curve objects</span></span>
<span><span class="va">zcurve_RE_Wang2025</span>    <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_zcurve.html">as_zcurve</a></span><span class="op">(</span><span class="va">fit_RE_Wang2025</span><span class="op">)</span></span>
<span><span class="va">zcurve_RoBMA_Wang2025</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_zcurve.html">as_zcurve</a></span><span class="op">(</span><span class="va">fit_RoBMA_Wang2025</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="z-curve-analysis">Z-Curve Analysis<a class="anchor" aria-label="anchor" href="#z-curve-analysis"></a>
</h4>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Assess model fit</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">zcurve_RoBMA_Wang2025</span>, from <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>, to <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span><span class="co">#&gt; 3 z-statistics are out of the plotting range</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">zcurve_RE_Wang2025</span>, col <span class="op">=</span> <span class="st">"black"</span>, lty <span class="op">=</span> <span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">2</span>, from <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>, to <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">zcurve_RoBMA_Wang2025</span>, col <span class="op">=</span> <span class="st">"blue"</span>, lty <span class="op">=</span> <span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">2</span>, from <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>, to <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, </span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Random-Effects"</span>, <span class="st">"RoBMA"</span><span class="op">)</span>, </span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"blue"</span><span class="op">)</span>, </span>
<span>       lty <span class="op">=</span> <span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="ZCurveDiagnostics_files/figure-html/unnamed-chunk-21-1.png" alt="ChatGPT: Model Fit Assessment" width="672"><p class="caption">
ChatGPT: Model Fit Assessment
</p>
</div>
</div>
<div class="section level4">
<h4 id="results">Results<a class="anchor" aria-label="anchor" href="#results"></a>
</h4>
<p>The z-curve plot for the ChatGPT data shows a different pattern than
the extreme publication bias observed in the social comparison example.
While we do not see strong selection at conventional significance
thresholds, there is a moderate discontinuity at the transition to
non-conforming results (z = 0), suggesting some degree of selection
against negative findings.</p>
<p>The random-effects model (black dashed line) provides a better fit to
the data than in the previous example;<br>
however, RoBMA (blue dashed line) captures the discontinuity at zero
slightly better. This visual pattern corresponds to moderate statistical
evidence for publication bias, highlighting a case where both models
might be considered, though the RoBMA model incorporates the uncertainty
about the best model and provides a more complete account of the data
patterns.</p>
</div>
<div class="section level4">
<h4 id="extrapolation-to-pre-publication-bias-1">Extrapolation to Pre-Publication Bias<a class="anchor" aria-label="anchor" href="#extrapolation-to-pre-publication-bias-1"></a>
</h4>
<p>We can examine the extrapolation to assess the impact of publication
bias:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Examine extrapolation</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">zcurve_RoBMA_Wang2025</span>, from <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>, to <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span><span class="co">#&gt; 3 z-statistics are out of the plotting range</span></span></code></pre></div>
<div class="figure">
<img src="ZCurveDiagnostics_files/figure-html/unnamed-chunk-22-1.png" alt="ChatGPT: Extrapolation Analysis" width="672"><p class="caption">
ChatGPT: Extrapolation Analysis
</p>
</div>
<p>The extrapolated distribution (blue line) shows a more modest
difference between the fitted and extrapolated distributions compared to
the extreme bias example, reflecting the moderate degree of publication
bias in this literature.</p>
</div>
<div class="section level4">
<h4 id="model-results-summary-2">Model Results Summary<a class="anchor" aria-label="anchor" href="#model-results-summary-2"></a>
</h4>
<p>To quantify these visual patterns, we examine the model
summaries:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_RE_Wang2025</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; RoBMA(d = d, r = r, logOR = logOR, OR = OR, z = z, y = y, se = se, </span></span>
<span><span class="co">#&gt;     v = v, n = n, lCI = lCI, uCI = uCI, t = t, study_names = study_names, </span></span>
<span><span class="co">#&gt;     study_ids = study_ids, data = data, transformation = transformation, </span></span>
<span><span class="co">#&gt;     prior_scale = prior_scale, effect_direction = "positive", </span></span>
<span><span class="co">#&gt;     model_type = model_type, priors_effect = priors_effect, priors_heterogeneity = priors_heterogeneity, </span></span>
<span><span class="co">#&gt;     priors_bias = NULL, priors_effect_null = priors_effect_null, </span></span>
<span><span class="co">#&gt;     priors_heterogeneity_null = priors_heterogeneity_null, priors_bias_null = prior_none(), </span></span>
<span><span class="co">#&gt;     priors_hierarchical = priors_hierarchical, priors_hierarchical_null = priors_hierarchical_null, </span></span>
<span><span class="co">#&gt;     algorithm = algorithm, chains = chains, sample = sample, </span></span>
<span><span class="co">#&gt;     burnin = burnin, adapt = adapt, thin = thin, parallel = parallel, </span></span>
<span><span class="co">#&gt;     autofit = autofit, autofit_control = autofit_control, convergence_checks = convergence_checks, </span></span>
<span><span class="co">#&gt;     save = save, seed = seed, silent = silent)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Bayesian model-averaged meta-analysis (normal-normal model)</span></span>
<span><span class="co">#&gt; Components summary:</span></span>
<span><span class="co">#&gt;               Prior prob. Post. prob. Inclusion BF</span></span>
<span><span class="co">#&gt; Effect              1.000       1.000          Inf</span></span>
<span><span class="co">#&gt; Heterogeneity       1.000       1.000          Inf</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model-averaged estimates:</span></span>
<span><span class="co">#&gt;      Mean Median 0.025 0.975</span></span>
<span><span class="co">#&gt; mu  0.788  0.788 0.568 1.009</span></span>
<span><span class="co">#&gt; tau 0.667  0.659 0.512 0.867</span></span>
<span><span class="co">#&gt; The estimates are summarized on the Cohen's d scale (priors were specified on the Cohen's d scale).</span></span>
<span><span class="co">#&gt; (Estimated publication weights omega correspond to one-sided p-values.)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_RoBMA_Wang2025</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; RoBMA(d = Wang2025$g, se = Wang2025$se, algorithm = "ss", chains = 5, </span></span>
<span><span class="co">#&gt;     sample = 10000, burnin = 5000, adapt = 5000, parallel = TRUE, </span></span>
<span><span class="co">#&gt;     save = "min", seed = 1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Robust Bayesian meta-analysis</span></span>
<span><span class="co">#&gt; Components summary:</span></span>
<span><span class="co">#&gt;               Prior prob. Post. prob. Inclusion BF</span></span>
<span><span class="co">#&gt; Effect              0.500       0.669        2.019</span></span>
<span><span class="co">#&gt; Heterogeneity       0.500       1.000          Inf</span></span>
<span><span class="co">#&gt; Bias                0.500       0.761        3.189</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model-averaged estimates:</span></span>
<span><span class="co">#&gt;                    Mean Median  0.025 0.975</span></span>
<span><span class="co">#&gt; mu                0.380  0.422 -0.042 0.935</span></span>
<span><span class="co">#&gt; tau               0.750  0.703  0.506 1.165</span></span>
<span><span class="co">#&gt; omega[0,0.025]    1.000  1.000  1.000 1.000</span></span>
<span><span class="co">#&gt; omega[0.025,0.05] 0.972  1.000  0.684 1.000</span></span>
<span><span class="co">#&gt; omega[0.05,0.5]   0.872  1.000  0.376 1.000</span></span>
<span><span class="co">#&gt; omega[0.5,0.95]   0.693  1.000  0.038 1.000</span></span>
<span><span class="co">#&gt; omega[0.95,0.975] 0.693  1.000  0.038 1.000</span></span>
<span><span class="co">#&gt; omega[0.975,1]    0.694  1.000  0.038 1.000</span></span>
<span><span class="co">#&gt; PET               0.647  0.000  0.000 3.345</span></span>
<span><span class="co">#&gt; PEESE             0.194  0.000  0.000 3.177</span></span>
<span><span class="co">#&gt; The estimates are summarized on the Cohen's d scale (priors were specified on the Cohen's d scale).</span></span>
<span><span class="co">#&gt; (Estimated publication weights omega correspond to one-sided p-values.)</span></span></code></pre></div>
<p>The random-effects model yields an effect size estimate of g = 0.79
[0.57, 1.01], while the RoBMA model accounting for selection produces a
more conservative g = 0.38 [-0.04, 0.94]. Importantly, the results show
an extreme degree of between-study heterogeneity, tau = 0.75 [0.51,
1.17], that greatly complicates feasible implications and
recommendations. This demonstrates the moderate nature of the
publication bias, where the adjusted estimate is meaningfully smaller
but not completely reduced. The Bayes factor for publication bias
(BF_bias = 3.2) provides moderate evidence for publication bias, and the
evidence for the effect becomes weak (BF_effect = 2).</p>
</div>
<div class="section level4">
<h4 id="z-curve-summary-metrics-2">Z-Curve Summary Metrics<a class="anchor" aria-label="anchor" href="#z-curve-summary-metrics-2"></a>
</h4>
<p>This moderate publication bias pattern is reflected in the summary
statistics,</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract z-curve summary metrics for ChatGPT data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">zcurve_RoBMA_Wang2025</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; as_zcurve: RoBMA(d = Wang2025$g, se = Wang2025$se, algorithm = "ss", chains = 5, </span></span>
<span><span class="co">#&gt;     sample = 10000, burnin = 5000, adapt = 5000, parallel = TRUE, </span></span>
<span><span class="co">#&gt;     save = "min", seed = 1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Z-curve</span></span>
<span><span class="co">#&gt; Model-averaged estimates:</span></span>
<span><span class="co">#&gt;             Mean Median 0.025  0.975</span></span>
<span><span class="co">#&gt; EDR        0.607  0.619 0.433  0.740</span></span>
<span><span class="co">#&gt; Soric FDR  0.036  0.032 0.018  0.069</span></span>
<span><span class="co">#&gt; Missing N 13.652  0.000 0.000 57.926</span></span>
<span><span class="co">#&gt; Estimated using 42 estimates, 27 significant (ODR = 0.64, 95 CI [0.48, 0.78]).</span></span></code></pre></div>
<p>which show a moderate-to-high EDR of 0.61 and around 14 missing
estimates.</p>
</div>
</div>
<div class="section level3">
<h3 id="example-4-framing-effects-from-many-labs-2">Example 4: Framing Effects from Many Labs 2<a class="anchor" aria-label="anchor" href="#example-4-framing-effects-from-many-labs-2"></a>
</h3>
<p>Our final example analyzes registered replication reports of the
classic framing effect on decision making <span class="citation">(Tversky &amp; Kahneman, 1981)</span> conducted as part
of the Many Labs 2 project <span class="citation">(Klein et al.,
2018)</span>. This dataset provides an ideal test case for z-curve
diagnostics because the pre-registered nature of these studies does not
allow for publication bias. The analysis includes 55 effect size
estimates that examine how framing influences decision-making
preferences.</p>
<div class="section level4">
<h4 id="data-analysis-and-model-fitting">Data Analysis and Model Fitting<a class="anchor" aria-label="anchor" href="#data-analysis-and-model-fitting"></a>
</h4>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the Many Labs 2 framing effect data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ManyLabs16"</span>, package <span class="op">=</span> <span class="st">"RoBMA"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ManyLabs16</span><span class="op">)</span></span>
<span><span class="co">#&gt;           y        se</span></span>
<span><span class="co">#&gt; 1 0.3507108 0.2198890</span></span>
<span><span class="co">#&gt; 2 0.1238568 0.1496303</span></span>
<span><span class="co">#&gt; 3 0.1752287 0.3055819</span></span>
<span><span class="co">#&gt; 4 0.5125227 0.2012544</span></span>
<span><span class="co">#&gt; 5 0.4573484 0.1505897</span></span>
<span><span class="co">#&gt; 6 0.6846411 0.1870689</span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit models and create z-curve objects</span></span>
<span><span class="va">fit_RE_ManyLabs16</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/NoBMA.html">NoBMA</a></span><span class="op">(</span>d <span class="op">=</span> <span class="va">ManyLabs16</span><span class="op">$</span><span class="va">y</span>, se <span class="op">=</span> <span class="va">ManyLabs16</span><span class="op">$</span><span class="va">se</span>, </span>
<span>                           priors_effect_null <span class="op">=</span> <span class="cn">NULL</span>, priors_heterogeneity_null <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                           algorithm <span class="op">=</span> <span class="st">"ss"</span>, sample <span class="op">=</span> <span class="fl">10000</span>, burnin <span class="op">=</span> <span class="fl">5000</span>, adapt <span class="op">=</span> <span class="fl">5000</span>, </span>
<span>                           chains <span class="op">=</span> <span class="fl">5</span>, parallel <span class="op">=</span> <span class="cn">TRUE</span>, seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">fit_RoBMA_ManyLabs16</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RoBMA.html">RoBMA</a></span><span class="op">(</span>d <span class="op">=</span> <span class="va">ManyLabs16</span><span class="op">$</span><span class="va">y</span>, se <span class="op">=</span> <span class="va">ManyLabs16</span><span class="op">$</span><span class="va">se</span>, </span>
<span>                              algorithm <span class="op">=</span> <span class="st">"ss"</span>, sample <span class="op">=</span> <span class="fl">10000</span>, burnin <span class="op">=</span> <span class="fl">5000</span>, adapt <span class="op">=</span> <span class="fl">5000</span>, </span>
<span>                              chains <span class="op">=</span> <span class="fl">5</span>, parallel <span class="op">=</span> <span class="cn">TRUE</span>, seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">zcurve_RE_ManyLabs16</span>    <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_zcurve.html">as_zcurve</a></span><span class="op">(</span><span class="va">fit_RE_ManyLabs16</span><span class="op">)</span></span>
<span><span class="va">zcurve_RoBMA_ManyLabs16</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_zcurve.html">as_zcurve</a></span><span class="op">(</span><span class="va">fit_RoBMA_ManyLabs16</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="z-curve-assessment">Z-Curve Assessment<a class="anchor" aria-label="anchor" href="#z-curve-assessment"></a>
</h4>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Assess model fit - should show good agreement</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">zcurve_RoBMA_ManyLabs16</span><span class="op">)</span></span>
<span><span class="co">#&gt; 2 z-statistics are out of the plotting range</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">zcurve_RE_ManyLabs16</span>, col <span class="op">=</span> <span class="st">"black"</span>, lty <span class="op">=</span> <span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">zcurve_RoBMA_ManyLabs16</span>, col <span class="op">=</span> <span class="st">"blue"</span>, lty <span class="op">=</span> <span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, </span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Random-Effects"</span>, <span class="st">"RoBMA"</span><span class="op">)</span>, </span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"blue"</span><span class="op">)</span>, </span>
<span>       lty <span class="op">=</span> <span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="ZCurveDiagnostics_files/figure-html/unnamed-chunk-27-1.png" alt="Framing Effects: Model Fit Assessment" width="672"><p class="caption">
Framing Effects: Model Fit Assessment
</p>
</div>
</div>
<div class="section level4">
<h4 id="results-1">Results<a class="anchor" aria-label="anchor" href="#results-1"></a>
</h4>
<p>The z-curve plot for the Many Labs 2 framing effects demonstrates
what we expect to see in the absence of publication bias. The observed
distribution of z-statistics (gray bars) appears smooth without sharp
discontinuities at significance thresholds or at zero. Both the
random-effects model (black dashed line) and RoBMA (blue dashed line)
provide essentially identical fits to the data, with their posterior
predictive distributions overlapping almost perfectly.</p>
<p>This close agreement between models indicates that either approach
would be appropriate for these data. The absence of publication bias is
further confirmed by the statistical evidence: RoBMA provides moderate
evidence against publication bias, demonstrating how the method
appropriately penalizes unnecessary model complexity when simpler models
explain the data equally well.</p>
</div>
<div class="section level4">
<h4 id="extrapolation-to-pre-publication-bias-2">Extrapolation to Pre-Publication Bias<a class="anchor" aria-label="anchor" href="#extrapolation-to-pre-publication-bias-2"></a>
</h4>
<p>We can examine whether there would be any difference in the absence
of publication bias:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extrapolation should show minimal change</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">zcurve_RoBMA_ManyLabs16</span><span class="op">)</span></span>
<span><span class="co">#&gt; 2 z-statistics are out of the plotting range</span></span></code></pre></div>
<div class="figure">
<img src="ZCurveDiagnostics_files/figure-html/unnamed-chunk-28-1.png" alt="Framing Effects: Extrapolation Analysis" width="672"><p class="caption">
Framing Effects: Extrapolation Analysis
</p>
</div>
<p>The extrapolated distribution (blue line) shows virtually no
difference between the fitted and extrapolated distributions, confirming
that publication bias has minimal impact in this well-designed
replication project. This example illustrates the ideal scenario where
traditional meta-analytic approaches are fully justified.</p>
</div>
<div class="section level4">
<h4 id="model-results-summary-3">Model Results Summary<a class="anchor" aria-label="anchor" href="#model-results-summary-3"></a>
</h4>
<p>The quantitative results confirm the visual impression:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_RE_ManyLabs16</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_RoBMA_ManyLabs16</span><span class="op">)</span></span></code></pre></div>
<p>Both models yield virtually identical effect size estimate of d =
0.43 [0.35, 0.49]. The Bayes factor for publication bias (BF_bias =
0.21) provides moderate evidence against the presence of publication
bias, appropriately penalizing the more complex model when it offers no
advantage. This demonstrates the method’s ability to distinguish between
necessary and unnecessary model complexity.</p>
</div>
<div class="section level4">
<h4 id="z-curve-summary-metrics-3">Z-Curve Summary Metrics<a class="anchor" aria-label="anchor" href="#z-curve-summary-metrics-3"></a>
</h4>
<p>The absence of publication bias is reflected in the publication bias
assessment statistics — a moderate EDR matching the ODR and no missing
studies.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract z-curve summary metrics for Many Labs 2 data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">zcurve_RoBMA_ManyLabs16</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; as_zcurve: RoBMA(d = ManyLabs16$y, se = ManyLabs16$se, algorithm = "ss", </span></span>
<span><span class="co">#&gt;     chains = 5, sample = 10000, burnin = 5000, adapt = 5000, </span></span>
<span><span class="co">#&gt;     parallel = TRUE, save = "min", seed = 1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Z-curve</span></span>
<span><span class="co">#&gt; Model-averaged estimates:</span></span>
<span><span class="co">#&gt;            Mean Median 0.025 0.975</span></span>
<span><span class="co">#&gt; EDR       0.587  0.596 0.452 0.675</span></span>
<span><span class="co">#&gt; Soric FDR 0.038  0.036 0.025 0.064</span></span>
<span><span class="co">#&gt; Missing N 0.344  0.000 0.000 4.289</span></span>
<span><span class="co">#&gt; Estimated using 55 estimates, 31 significant (ODR = 0.56, 95 CI [0.42, 0.69]).</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="conclusions">Conclusions<a class="anchor" aria-label="anchor" href="#conclusions"></a>
</h2>
<p>Z-curve plots are an intuitive diagnostic tool for assessing
publication bias and model fit <span class="citation">(Bartoš &amp;
Schimmack, 2025)</span>. By visualizing the distribution of test
statistics and comparing observed patterns with model-implied
expectations, researchers can make more informed decisions about their
analytic approach using the RoBMA package <span class="citation">(Bartoš
&amp; Maier, 2020)</span>.</p>
<p>Z-curve diagnostics are particularly informative when applied to
moderate to large meta-analyses (typically &gt;20-30 studies), where
histogram patterns become interpretable. Publication bias and QRP might
produce similar patterns of results. The z-curve diagnostics cannot
distinguish between them; however, it might help in assessing whether
the model approximates the observed data well. They are especially
useful for model comparison scenarios when they provide a visual
supplement to statistical tests like inclusion Bayes factors.</p>
<p>The following points are important for interpreting z-curve
diagnostics:</p>
<ul>
<li>Sharp drops in the observed distribution at z = 0, z = ±1.64, or z =
±1.96 suggest publication bias.</li>
<li>Models whose posterior predictive distributions closely match the
observed pattern should be preferred.</li>
<li>Large differences between fitted and extrapolated distributions
indicate substantial publication bias.</li>
<li>Visual assessment should complement formal statistical tests.</li>
</ul>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0" line-spacing="2">
<div id="ref-RoBMA" class="csl-entry">
Bartoš, F., &amp; Maier, M. (2020). <em><span>RoBMA</span>:
<span>A</span>n <span>R</span> package for robust <span>B</span>ayesian
meta-analyses</em>. <a href="https://CRAN.R-project.org/package=RoBMA" class="external-link">https://CRAN.R-project.org/package=RoBMA</a>
</div>
<div id="ref-bartos2025robust" class="csl-entry">
Bartoš, F., Maier, M., &amp; Wagenmakers, E.-J. (2025). <em>Robust
<span>B</span>ayesian multilevel meta-analysis: <span>A</span>djusting
for publication bias in the presence of dependent effect sizes</em>. <a href="https://doi.org/10.31234/osf.io/9tgp2_v1" class="external-link">https://doi.org/10.31234/osf.io/9tgp2_v1</a>
</div>
<div id="ref-bartos2021no" class="csl-entry">
Bartoš, F., Maier, M., Wagenmakers, E.-J., Doucouliagos, H., &amp;
Stanley, T. D. (2023). Robust <span>B</span>ayesian meta-analysis:
<span>M</span>odel-averaging across complementary publication bias
adjustment methods. <em>Research Synthesis Methods</em>, <em>14</em>(1),
99–116. <a href="https://doi.org/10.1002/jrsm.1594" class="external-link">https://doi.org/10.1002/jrsm.1594</a>
</div>
<div id="ref-bartos2025zcurve" class="csl-entry">
Bartoš, F., &amp; Schimmack, U. (2025). Z-curve plot: <span>A</span>
visual diagnostic for publication bias in meta-analysis. In
<em>arXiv</em>. <a href="https://doi.org/10.48550/arXiv.2509.07171" class="external-link">https://doi.org/10.48550/arXiv.2509.07171</a>
</div>
<div id="ref-brunner2020estimating" class="csl-entry">
Brunner, J., &amp; Schimmack, U. (2020). Estimating population mean
power under conditions of heterogeneity and selection for significance.
<em>Meta-Psychology</em>, <em>4</em>. <a href="https://doi.org/10.15626/MP.2018.874" class="external-link">https://doi.org/10.15626/MP.2018.874</a>
</div>
<div id="ref-gabry2019visualization" class="csl-entry">
Gabry, J., Simpson, D., Vehtari, A., Betancourt, M., &amp; Gelman, A.
(2019). Visualization in <span>B</span>ayesian workflow. <em>Journal of
the Royal Statistical Society Series A: Statistics in Society</em>,
<em>182</em>(2), 389–402. <a href="https://doi.org/10.1111/rssa.12378" class="external-link">https://doi.org/10.1111/rssa.12378</a>
</div>
<div id="ref-hoppen2025meta" class="csl-entry">
Hoppen, T. H., Cuno, R. M., Nelson, J., Lemmel, F., Schlechter, P.,
&amp; Morina, N. (2025). Meta-analysis of randomized controlled trials
examining social comparison as a behaviour change technique across the
behavioural sciences. <em>Nature Human Behaviour</em>, <em>9</em>(8),
1595–1612. <a href="https://doi.org/10.1038/s41562-025-02209-2" class="external-link">https://doi.org/10.1038/s41562-025-02209-2</a>
</div>
<div id="ref-klein2018many" class="csl-entry">
Klein, R. A., Vianello, M., Hasselman, F., Adams, B. G., Adams Jr, R.
B., Alper, S., Aveyard, M., Axt, J. R., Babalola, M. T., Bahník, Š., et
al. (2018). <span>M</span>any <span>L</span>abs 2:
<span>I</span>nvestigating variation in replicability across samples and
settings. <em>Advances in Methods and Practices in Psychological
Science</em>, <em>1</em>(4), 443–490. <a href="https://doi.org/10.1177/2515245918810225" class="external-link">https://doi.org/10.1177/2515245918810225</a>
</div>
<div id="ref-maier2020robust" class="csl-entry">
Maier, M., Bartoš, F., &amp; Wagenmakers, E.-J. (2023). Robust
<span>B</span>ayesian meta-analysis: <span>A</span>ddressing publication
bias with model-averaging. <em>Psychological Methods</em>,
<em>28</em>(1), 107–122. <a href="https://doi.org/10.1037/met0000405" class="external-link">https://doi.org/10.1037/met0000405</a>
</div>
<div id="ref-tversky1981framing" class="csl-entry">
Tversky, A., &amp; Kahneman, D. (1981). The framing of decisions and the
psychology of choice. <em>Science</em>, <em>211</em>(4481), 453–458. <a href="https://doi.org/10.1126/science.7455683" class="external-link">https://doi.org/10.1126/science.7455683</a>
</div>
<div id="ref-wang2025effect" class="csl-entry">
Wang, J., &amp; Fan, W. (2025). The effect of <span>ChatGPT</span> on
students’ learning performance, learning perception, and higher-order
thinking: Insights from a meta-analysis. <em>Humanities and Social
Sciences Communications</em>, <em>12</em>(1), 1–21. <a href="https://doi.org/10.1057/s41599-025-04787-y" class="external-link">https://doi.org/10.1057/s41599-025-04787-y</a>
</div>
<div id="ref-weingarten2018does" class="csl-entry">
Weingarten, E., &amp; Hutchinson, J. W. (2018). Does ease mediate the
ease-of-retrieval effect? <span>A</span> meta-analysis.
<em>Psychological Bulletin</em>, <em>144</em>(3), 227–283. <a href="https://doi.org/10.1037/bul0000122" class="external-link">https://doi.org/10.1037/bul0000122</a>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by František Bartoš, Maximilian Maier.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
