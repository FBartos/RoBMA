<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fitting custom meta-analytic ensembles • RoBMA</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Fitting custom meta-analytic ensembles">
<meta property="og:description" content="RoBMA">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RoBMA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/CustomEnsembles.html">Fitting custom meta-analytic ensembles</a>
    </li>
    <li>
      <a href="../articles/ReproducingBMA.html">Reproducing BMA</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/FBartos/RoBMA/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="CustomEnsembles_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Fitting custom meta-analytic ensembles</h1>
                        <h4 class="author">František Bartoš</h4>
            
            <h4 class="date">2021-07-15</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/FBartos/RoBMA/blob/master/vignettes/CustomEnsembles.Rmd"><code>vignettes/CustomEnsembles.Rmd</code></a></small>
      <div class="hidden name"><code>CustomEnsembles.Rmd</code></div>

    </div>

    
    
<p>By default, the <code><a href="../reference/RoBMA.html">RoBMA()</a></code> function specifies models as a combination of all supplied prior distributions (across null and alternative specification), with their prior model weights being equal to the product of prior distributions’ weights. This results in the 36 meta-analytic models using the default settings <span class="citation">(Bartoš et al., 2021)</span><span class="math inline">\(^1\)</span>. In <a href="ReproducingBMA.html">another vignette</a>, we illustrated that RoBMA can be also utilized for reproducing Bayesian Model-Averaged Meta-Analysis (BMA) <span class="citation">(Gronau et al., 2017)</span>. However, the package was built as a framework for estimating highly customized meta-analytic model ensembles. Here, we are going to illustrate how to do exactly that (see <span class="citation">Bartoš et al. (2020)</span> for a tutorial paper on customizing the model ensemble with JASP).</p>
<p>Please keep in mind that all models should be justified by theory. Furthermore, the models should be tested to make sure that the ensemble can perform as intended a priori to drawing inference from it. The following sections are only for illustrating the functionality of the package. We provide a completely discussion with the relevant sources in the Example section of <span class="citation">Bartoš et al. (2021)</span>.</p>
<div id="the-dataset" class="section level3">
<h3 class="hasAnchor">
<a href="#the-dataset" class="anchor"></a>The dataset</h3>
<p>To illustrate the custom model building procedure, we use data from the infamous <span class="citation">Bem (2011)</span> “Feeling the future” pre-cognition study. We use coding of the results as summarized by Bem in one of his later replies <span class="citation">(Bem et al., 2011)</span>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://fbartos.github.io/RoBMA/">RoBMA</a></span><span class="op">)</span>
<span class="co">#&gt; Loading required namespace: runjags</span>
<span class="co">#&gt; module RoBMA loaded</span>
<span class="co">#&gt; This is a 2.0 version of the RoBMA package (see NEWS for detailed overview of the changes).</span>

<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"Bem2011"</span>, package <span class="op">=</span> <span class="st">"RoBMA"</span><span class="op">)</span>
<span class="va">Bem2011</span>
<span class="co">#&gt;      d         se                                        study</span>
<span class="co">#&gt; 1 0.25 0.10155048                  Detection of Erotic Stimuli</span>
<span class="co">#&gt; 2 0.20 0.08246211                Avoidance of Negative Stimuli</span>
<span class="co">#&gt; 3 0.26 0.10323629                        Retroactive Priming I</span>
<span class="co">#&gt; 4 0.23 0.10182427                       Retroactive Priming II</span>
<span class="co">#&gt; 5 0.22 0.10120277  Retroactive Habituation I - Negative trials</span>
<span class="co">#&gt; 6 0.15 0.08210765 Retroactive Habituation II - Negative trials</span>
<span class="co">#&gt; 7 0.09 0.07085372             Retroactive Induction of Boredom</span>
<span class="co">#&gt; 8 0.19 0.10089846                     Facilitation of Recall I</span>
<span class="co">#&gt; 9 0.42 0.14752627                    Facilitation of Recall II</span></code></pre></div>
</div>
<div id="the-custom-ensemble" class="section level3">
<h3 class="hasAnchor">
<a href="#the-custom-ensemble" class="anchor"></a>The custom ensemble</h3>
<p>We consider the following scenarios as plausible explanations for the data, and decide to include only those models into the meta-analytic ensemble:</p>
<ol style="list-style-type: decimal">
<li>there is absolutely no precognition effect - a fixed effects model assuming the effect size to be zero (<span class="math inline">\(H_{0}^f\)</span>),</li>
<li>the experiments measured the same underlying precognition effect - a fixed effects model (<span class="math inline">\(H_{1}^f\)</span>),</li>
<li>each of the experiments measured a slightly different precognition effect - a random effects model (<span class="math inline">\(H_{1}^r\)</span>),</li>
<li>there is absolutely no precognition effect and the results can be explained away with publication bias, modeled with one of the following publication bias adjustments: - 4.1) one-sided selection operating on significant <em>p</em>-values (<span class="math inline">\(H_{1,\text{pb1}}^f\)</span>), - 4.2) one-sided selection operating on significant and marginally significant <em>p</em>-values (<span class="math inline">\(H_{1,\text{pb2}}^f\)</span>), - 4.3) PET correction for publication bias which adjusts for the relationship between effect sizes and standard errors (<span class="math inline">\(H_{1,\text{pb3}}^f\)</span>), - 4.4) PEESE correction for publication bias which adjusts for the relationship between effect sizes and standard errors squared (<span class="math inline">\(H_{1,\text{pb4}}^f\)</span>).</li>
</ol>
<p>If we were to fit the ensemble using the <code><a href="../reference/RoBMA.html">RoBMA()</a></code> function and specifying all of the priors, we would have ended with 2 (effect or no effect) * 2 (heterogeneity or no heterogeneity) * 5 (no publication bias or 4 ways of adjusting for publication bias) = 20 models. That is 13 models more than requested. Furthermore, we could not specify different parameters for the prior distributions for each model, which the following process allows (but we do not utilize it).</p>
<p>We start with fitting only the first model using the <code><a href="../reference/RoBMA.html">RoBMA()</a></code> function and we will continuously update the fitted object to include all of the models.</p>
<div id="model-1" class="section level4">
<h4 class="hasAnchor">
<a href="#model-1" class="anchor"></a>Model 1</h4>
<p>We initiate the model ensemble by specifying only the first model with the <code><a href="../reference/RoBMA.html">RoBMA()</a></code> function. We explicitly specify prior distributions for all components and set the prior distributions to correspond to the null hypotheses and set seed to ensure reproducibility of the results.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RoBMA.html">RoBMA</a></span><span class="op">(</span>d <span class="op">=</span> <span class="va">Bem2011</span><span class="op">$</span><span class="va">d</span>, se <span class="op">=</span> <span class="va">Bem2011</span><span class="op">$</span><span class="va">se</span>, study_names <span class="op">=</span> <span class="va">Bem2011</span><span class="op">$</span><span class="va">study</span>,
             priors_effect <span class="op">=</span> <span class="cn">NULL</span>, priors_heterogeneity <span class="op">=</span> <span class="cn">NULL</span>, priors_bias <span class="op">=</span> <span class="cn">NULL</span>,
             priors_effect_null        <span class="op">=</span> <span class="fu"><a href="../reference/prior.html">prior</a></span><span class="op">(</span><span class="st">"spike"</span>, parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>location <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,
             priors_heterogeneity_null <span class="op">=</span> <span class="fu"><a href="../reference/prior.html">prior</a></span><span class="op">(</span><span class="st">"spike"</span>, parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>location <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,
             priors_bias_null          <span class="op">=</span> <span class="fu"><a href="../reference/prior_none.html">prior_none</a></span><span class="op">(</span><span class="op">)</span>,
             seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p>We verify that the ensemble contains only the single specified model with the <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> function by setting <code>type = "models"</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit</span>, type <span class="op">=</span> <span class="st">"models"</span><span class="op">)</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; RoBMA(d = Bem2011$d, se = Bem2011$se, study_names = Bem2011$study, </span>
<span class="co">#&gt;     priors_effect = NULL, priors_heterogeneity = NULL, priors_bias = NULL, </span>
<span class="co">#&gt;     priors_effect_null = prior("spike", parameters = list(location = 0)), </span>
<span class="co">#&gt;     priors_heterogeneity_null = prior("spike", parameters = list(location = 0)), </span>
<span class="co">#&gt;     priors_bias_null = prior_none(), seed = 1)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Robust Bayesian meta-analysis</span>
<span class="co">#&gt; Models overview:</span>
<span class="co">#&gt;  Model Prior Effect Prior Heterogeneity Prior Bias Prior prob. log(marglik)</span>
<span class="co">#&gt;      1     Spike(0)            Spike(0)                  1.000        -3.28</span>
<span class="co">#&gt;  Post. prob. Inclusion BF</span>
<span class="co">#&gt;        1.000          Inf</span></code></pre></div>
</div>
<div id="model-2" class="section level4">
<h4 class="hasAnchor">
<a href="#model-2" class="anchor"></a>Model 2</h4>
<p>Before we add the second model to the ensemble, we need to decide on the prior distribution for the mean parameter. If pre-cognition were to exist, the effect would be small since all casinos would be bankrupted otherwise. The effect would also be positive, since any deviation from randomness could be characterized as an effect. Therefore, we decide to use a normal distribution with mean = 0.15, standard deviation 0.10, and truncated to the positive range. This sets the prior density around small effect sizes. To get a better grasp of the prior distribution, we visualize it using the <code>plot())</code> function (the figure can be also created using the ggplot2 package by adding <code>plot_type == "ggplot"</code> argument).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/prior.html">prior</a></span><span class="op">(</span><span class="st">"normal"</span>, parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">.15</span>, sd <span class="op">=</span> <span class="fl">.10</span><span class="op">)</span>, truncation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>lower <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="CustomEnsembles_files/figure-html/fig_mu_prior-1.png" width="50%" style="display: block; margin: auto;"></p>
<p>We add the second model to the ensemble using the <code><a href="../reference/update.RoBMA.html">update.RoBMA()</a></code> function. The function can also be used to many other purposes - updating settings, prior model weights, and refitting failed models. Here, we supply the fitted ensemble object and add an argument specifying the prior distributions of each components for the additional model. Since we want to add Model 2 - we set the prior for the <span class="math inline">\(\mu\)</span> parameter to be treated as a prior belonging to the alternative hypothesis of the effect size component and the remaining priors treated as belonging to the alternative hypotheses. If we wanted, we could also specify <code>prior_weights</code> argument, to change the prior probability of the fitted model but we do not utilize this option here and keep the default value, which sets the prior weights for the new model to <code>1</code>. (Note that the arguments for specifying prior distributions in <code><a href="../reference/update.RoBMA.html">update.RoBMA()</a></code> function are <code>prior_X</code> - in singular, in comparison to <code><a href="../reference/RoBMA.html">RoBMA()</a></code> function that uses <code>priors_X</code> in plural.)</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span><span class="va">fit</span>,
              prior_effect             <span class="op">=</span> <span class="fu"><a href="../reference/prior.html">prior</a></span><span class="op">(</span><span class="st">"normal"</span>, parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">.15</span>, sd <span class="op">=</span> <span class="fl">.10</span><span class="op">)</span>, truncation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>lower <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,
              prior_heterogeneity_null <span class="op">=</span> <span class="fu"><a href="../reference/prior.html">prior</a></span><span class="op">(</span><span class="st">"spike"</span>,  parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>location <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,
              prior_bias_null          <span class="op">=</span> <span class="fu"><a href="../reference/prior_none.html">prior_none</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>We can again inspect the updated ensemble to verify that it contains both models. We see that Model 2 notably outperformed the first model and attained all of the posterior model probability.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit</span>, type <span class="op">=</span> <span class="st">"models"</span><span class="op">)</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; RoBMA(d = Bem2011$d, se = Bem2011$se, study_names = Bem2011$study, </span>
<span class="co">#&gt;     priors_effect = NULL, priors_heterogeneity = NULL, priors_bias = NULL, </span>
<span class="co">#&gt;     priors_effect_null = prior("spike", parameters = list(location = 0)), </span>
<span class="co">#&gt;     priors_heterogeneity_null = prior("spike", parameters = list(location = 0)), </span>
<span class="co">#&gt;     priors_bias_null = prior_none(), seed = 1)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Robust Bayesian meta-analysis</span>
<span class="co">#&gt; Models overview:</span>
<span class="co">#&gt;  Model        Prior Effect       Prior Heterogeneity Prior Bias Prior prob.</span>
<span class="co">#&gt;      1                  Spike(0)            Spike(0)                  0.500</span>
<span class="co">#&gt;      2 Normal(0.15, 0.1)[0, Inf]            Spike(0)                  0.500</span>
<span class="co">#&gt;  log(marglik) Post. prob. Inclusion BF</span>
<span class="co">#&gt;         -3.28       0.000        0.000</span>
<span class="co">#&gt;         14.91       1.000          Inf</span></code></pre></div>
</div>
<div id="models-3-4-4" class="section level4">
<h4 class="hasAnchor">
<a href="#models-3-4-4" class="anchor"></a>Models 3-4.4</h4>
<p>Before we add the remaining models to the ensemble using the <code><a href="https://rdrr.io/r/stats/update.html">update()</a></code> function, we need to decide on the remaining prior distributions. Specifically, on the prior distribution for the heterogeneity parameter <span class="math inline">\(\tau\)</span>, and the publication bias adjustment parameters <span class="math inline">\(\omega\)</span> (for the selection models’ weightfunctions) and PET and PEESE for the PET and PEESE adjustment.</p>
<p>For Model 3, we use the usual inverse-gamma(1, .15) prior distribution based on empirical heterogeneity estimates <span class="citation">(Erp et al., 2017)</span> for the heterogeneity parameter <span class="math inline">\(\tau\)</span>. For Models 4.1-4.4 we use the default settings for the publication bias adjustments as outlined the Appendix B of <span class="citation">(Bartoš et al., 2021)</span>.</p>
<p>Now, we just need to add the remaining models to the ensemble using the <code><a href="https://rdrr.io/r/stats/update.html">update()</a></code> function as already illustrated.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">### adding Model 3</span>
<span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span><span class="va">fit</span>,
              prior_effect        <span class="op">=</span> <span class="fu"><a href="../reference/prior.html">prior</a></span><span class="op">(</span><span class="st">"normal"</span>, parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">.15</span>, sd <span class="op">=</span> <span class="fl">.10</span><span class="op">)</span>, truncation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>lower <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,
              prior_heterogeneity <span class="op">=</span> <span class="fu"><a href="../reference/prior.html">prior</a></span><span class="op">(</span><span class="st">"invgamma"</span>, parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">1</span>, scale <span class="op">=</span> <span class="fl">.15</span><span class="op">)</span><span class="op">)</span>,
              prior_bias_null     <span class="op">=</span> <span class="fu"><a href="../reference/prior_none.html">prior_none</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>

<span class="co">### adding Model 4.1</span>
<span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span><span class="va">fit</span>,
              prior_effect_null        <span class="op">=</span> <span class="fu"><a href="../reference/prior.html">prior</a></span><span class="op">(</span><span class="st">"spike"</span>,     parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>location <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,
              prior_heterogeneity_null <span class="op">=</span> <span class="fu"><a href="../reference/prior.html">prior</a></span><span class="op">(</span><span class="st">"spike"</span>,     parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>location <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,
              prior_bias               <span class="op">=</span> <span class="fu"><a href="../reference/prior_weightfunction.html">prior_weightfunction</a></span><span class="op">(</span><span class="st">"one.sided"</span>, parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, steps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.05</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
              
<span class="co">### adding Model 4.2</span>
<span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span><span class="va">fit</span>,
              prior_effect_null        <span class="op">=</span> <span class="fu"><a href="../reference/prior.html">prior</a></span><span class="op">(</span><span class="st">"spike"</span>,     parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>location <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,
              prior_heterogeneity_null <span class="op">=</span> <span class="fu"><a href="../reference/prior.html">prior</a></span><span class="op">(</span><span class="st">"spike"</span>,     parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>location <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,
              prior_bias               <span class="op">=</span> <span class="fu"><a href="../reference/prior_weightfunction.html">prior_weightfunction</a></span><span class="op">(</span><span class="st">"one.sided"</span>, parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, steps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
              
<span class="co">### adding Model 4.3</span>
<span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span><span class="va">fit</span>,
              prior_effect_null        <span class="op">=</span> <span class="fu"><a href="../reference/prior.html">prior</a></span><span class="op">(</span><span class="st">"spike"</span>,     parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>location <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,
              prior_heterogeneity_null <span class="op">=</span> <span class="fu"><a href="../reference/prior.html">prior</a></span><span class="op">(</span><span class="st">"spike"</span>,     parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>location <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,
              prior_bias               <span class="op">=</span> <span class="fu"><a href="../reference/prior_PET.html">prior_PET</a></span><span class="op">(</span><span class="st">"Cauchy"</span>, parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,  truncation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>lower <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
              
<span class="co">### adding Model 4.4</span>
<span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span><span class="va">fit</span>,
              prior_effect_null        <span class="op">=</span> <span class="fu"><a href="../reference/prior.html">prior</a></span><span class="op">(</span><span class="st">"spike"</span>,     parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>location <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,
              prior_heterogeneity_null <span class="op">=</span> <span class="fu"><a href="../reference/prior.html">prior</a></span><span class="op">(</span><span class="st">"spike"</span>,     parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>location <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,
              prior_bias               <span class="op">=</span> <span class="fu"><a href="../reference/prior_PEESE.html">prior_PEESE</a></span><span class="op">(</span><span class="st">"Cauchy"</span>, parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span>,  truncation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>lower <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>We again verify that all of the requested models are included in the ensemble using the <code>summary())</code> function with <code>type = "models"</code> argument.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit</span>, type <span class="op">=</span> <span class="st">"models"</span><span class="op">)</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; RoBMA(d = Bem2011$d, se = Bem2011$se, study_names = Bem2011$study, </span>
<span class="co">#&gt;     priors_effect = NULL, priors_heterogeneity = NULL, priors_bias = NULL, </span>
<span class="co">#&gt;     priors_effect_null = prior("spike", parameters = list(location = 0)), </span>
<span class="co">#&gt;     priors_heterogeneity_null = prior("spike", parameters = list(location = 0)), </span>
<span class="co">#&gt;     priors_bias_null = prior_none(), seed = 1)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Robust Bayesian meta-analysis</span>
<span class="co">#&gt; Models overview:</span>
<span class="co">#&gt;  Model        Prior Effect       Prior Heterogeneity</span>
<span class="co">#&gt;      1                  Spike(0)            Spike(0)</span>
<span class="co">#&gt;      2 Normal(0.15, 0.1)[0, Inf]            Spike(0)</span>
<span class="co">#&gt;      3 Normal(0.15, 0.1)[0, Inf]   InvGamma(1, 0.15)</span>
<span class="co">#&gt;      4                  Spike(0)            Spike(0)</span>
<span class="co">#&gt;      5                  Spike(0)            Spike(0)</span>
<span class="co">#&gt;      6                  Spike(0)            Spike(0)</span>
<span class="co">#&gt;      7                  Spike(0)            Spike(0)</span>
<span class="co">#&gt;                      Prior Bias                     Prior prob. log(marglik)</span>
<span class="co">#&gt;                                                           0.143        -3.28</span>
<span class="co">#&gt;                                                           0.143        14.91</span>
<span class="co">#&gt;                                                           0.143        12.85</span>
<span class="co">#&gt;       omega[one-sided: .05] ~ CumDirichlet(1, 1)          0.143        13.70</span>
<span class="co">#&gt;   omega[one-sided: .1, .05] ~ CumDirichlet(1, 1, 1)       0.143        12.58</span>
<span class="co">#&gt;                         PET ~ Cauchy(0, 1)[0, Inf]        0.143        15.75</span>
<span class="co">#&gt;                       PEESE ~ Cauchy(0, 5)[0, Inf]        0.143        15.65</span>
<span class="co">#&gt;  Post. prob. Inclusion BF</span>
<span class="co">#&gt;        0.000        0.000</span>
<span class="co">#&gt;        0.168        1.210</span>
<span class="co">#&gt;        0.021        0.132</span>
<span class="co">#&gt;        0.050        0.318</span>
<span class="co">#&gt;        0.016        0.100</span>
<span class="co">#&gt;        0.391        3.845</span>
<span class="co">#&gt;        0.353        3.278</span></code></pre></div>
</div>
</div>
<div id="using-the-fitted-ensemble" class="section level3">
<h3 class="hasAnchor">
<a href="#using-the-fitted-ensemble" class="anchor"></a>Using the fitted ensemble</h3>
<p>Finally, we use the <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> function to inspect the model results. The results from our custom ensemble indicate weak evidence for the absence of the pre-cognition effect, <span class="math inline">\(\text{BF}_{10} = 0.584\)</span> -&gt; <span class="math inline">\(\text{BF}_{01} = 1.71\)</span>, moderate evidence for the absence of heterogeneity, <span class="math inline">\(\text{BF}_{\text{rf}} = 0.132\)</span> -&gt; <span class="math inline">\(\text{BF}_{\text{fr}} = 7.58\)</span>, and moderate evidence for the presence of the publication bias, <span class="math inline">\(\text{BF}_{\text{pb}} = 3.21\)</span>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; RoBMA(d = Bem2011$d, se = Bem2011$se, study_names = Bem2011$study, </span>
<span class="co">#&gt;     priors_effect = NULL, priors_heterogeneity = NULL, priors_bias = NULL, </span>
<span class="co">#&gt;     priors_effect_null = prior("spike", parameters = list(location = 0)), </span>
<span class="co">#&gt;     priors_heterogeneity_null = prior("spike", parameters = list(location = 0)), </span>
<span class="co">#&gt;     priors_bias_null = prior_none(), seed = 1)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Robust Bayesian meta-analysis</span>
<span class="co">#&gt; Components summary:</span>
<span class="co">#&gt;               Models Prior prob. Post. prob. Inclusion BF</span>
<span class="co">#&gt; Effect           2/7       0.286       0.189        0.584</span>
<span class="co">#&gt; Heterogeneity    1/7       0.143       0.021        0.132</span>
<span class="co">#&gt; Bias             4/7       0.571       0.811        3.212</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model-averaged estimates:</span>
<span class="co">#&gt;                  Mean Median 0.025  0.975</span>
<span class="co">#&gt; mu              0.036  0.000 0.000  0.226</span>
<span class="co">#&gt; tau             0.002  0.000 0.000  0.000</span>
<span class="co">#&gt; omega[0,0.05]   1.000  1.000 1.000  1.000</span>
<span class="co">#&gt; omega[0.05,0.1] 0.938  1.000 0.014  1.000</span>
<span class="co">#&gt; omega[0.1,1]    0.935  1.000 0.012  1.000</span>
<span class="co">#&gt; PET             0.820  0.000 0.000  2.601</span>
<span class="co">#&gt; PEESE           7.284  0.000 0.000 25.508</span></code></pre></div>
<p>The finalized ensemble can be treated as any other <code>RoBMA</code> ensemble using the <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code>, <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code>, <code><a href="../reference/plot_models.html">plot_models()</a></code>, <code><a href="../reference/forest.html">forest()</a></code>, and <code><a href="../reference/diagnostics.html">diagnostics()</a></code> functions. For example, we can use the <code><a href="../reference/plot.RoBMA.html">plot.RoBMA()</a></code> with the <code>parameter = "mu", prior = TRUE</code> arguments to plot the prior (grey) and posterior distribution (black) for the effect size. The function visualizes the model-averaged estimates across all models by default. The arrows stand for the probability of a spike, here, at the value 0. The secondary y-axis (right) shows the probability of the value 0, increasing from 0.71, to 0.81.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">fit</span>, parameter <span class="op">=</span> <span class="st">"mu"</span>, prior <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="CustomEnsembles_files/figure-html/fig_mu_posterior-1.png" width="50%" style="display: block; margin: auto;"></p>
<p>We can also inspect the posterior distributions of the publication bias adjustments. To visualize the model-averaged weightfunction, we change set <code>parameter = weightfunction</code> argument, with the prior distribution in light gray and the posterior distribution in the dark gray,</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">fit</span>, parameter <span class="op">=</span> <span class="st">"weightfunction"</span>, prior <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="CustomEnsembles_files/figure-html/fig_weightfunction_posterior-1.png" width="75%" style="display: block; margin: auto;"> and the posterior estimate of the regression relationship between the standard errors and effect sizes by setting <code>parameter = "PET-PEESE"</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">fit</span>, parameter <span class="op">=</span> <span class="st">"PET-PEESE"</span>, prior <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="CustomEnsembles_files/figure-html/fig_PETPEESE_posterior-1.png" width="75%" style="display: block; margin: auto;"></p>
</div>
<div id="footnotes" class="section level3">
<h3 class="hasAnchor">
<a href="#footnotes" class="anchor"></a>Footnotes</h3>
<p><span class="math inline">\(^1\)</span> - The default setting used to produce 12 models in RoBMA versions &lt; 2, which corresponded to earlier an article by <span class="citation">Maier et al. (n.d.)</span> in which we applied Bayesian model-averaging only across selection models.</p>
</div>
<div id="references" class="section level3 unnumbered">
<h3 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h3>
<div id="refs" class="references">
<div id="ref-bartos2020adjusting">
<p>Bartoš, F., Maier, M., &amp; Wagenmakers, E.-J. (2020). Adjusting for publication bias in JASP — selection models and robust Bayesian meta-analysis. In <em>PsyArXiv</em>. <a href="https://doi.org/10.31234/osf.io/75bqn">https://doi.org/10.31234/osf.io/75bqn</a></p>
</div>
<div id="ref-bartos2021no">
<p>Bartoš, F., Maier, M., Wagenmakers, E.-J., Doucouliagos, H., &amp; Stanley, T. D. (2021). <em>Need to choose: Robust Bayesian meta-analysis with competing publication bias adjustment methods</em>. PsyArXiv. <a href="https://doi.org/10.31234/osf.io/kvsp7">https://doi.org/10.31234/osf.io/kvsp7</a></p>
</div>
<div id="ref-bem2011feeling">
<p>Bem, D. J. (2011). Feeling the future: Experimental evidence for anomalous retroactive influences on cognition and affect. <em>Journal of Personality and Social Psychology</em>, <em>100</em>(3), 407. <a href="https://doi.org/10.1037/a0021524">https://doi.org/10.1037/a0021524</a></p>
</div>
<div id="ref-bem2011must">
<p>Bem, D. J., Utts, J., &amp; Johnson, W. O. (2011). Must psychologists change the way they analyze their data? <em>Journal of Personality and Social Psychology</em>, <em>101</em>(4), 716. <a href="https://doi.org/10.1037/a0024777">https://doi.org/10.1037/a0024777</a></p>
</div>
<div id="ref-erp2017estimates">
<p>Erp, S. van, Verhagen, J., Grasman, R. P., &amp; Wagenmakers, E.-J. (2017). Estimates of between-study heterogeneity for 705 meta-analyses reported in Psychological Bulletin from 1990–2013. <em>Journal of Open Psychology Data</em>, <em>5</em>(1). <a href="https://doi.org/10.5334/jopd.33">https://doi.org/10.5334/jopd.33</a></p>
</div>
<div id="ref-gronau2017bayesian">
<p>Gronau, Q. F., Van Erp, S., Heck, D. W., Cesario, J., Jonas, K. J., &amp; Wagenmakers, E.-J. (2017). A Bayesian model-averaged meta-analysis of the power pose effect with informed and default priors: The case of felt power. <em>Comprehensive Results in Social Psychology</em>, <em>2</em>(1), 123–138. <a href="https://doi.org/10.1080/23743603.2017.1326760">https://doi.org/10.1080/23743603.2017.1326760</a></p>
</div>
<div id="ref-maier2020robust">
<p>Maier, M., Bartoš, F., &amp; Wagenmakers, E.-J. (n.d.). Robust Bayesian meta-analysis: Addressing publication bias with model-averaging. <em>Psychological Methods</em>. <a href="https://doi.org/10.31234/osf.io/u4cns">https://doi.org/10.31234/osf.io/u4cns</a></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by František Bartoš, Maximilian Maier.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
