<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Informed Bayesian Model-Averaged Meta-Analysis in Medicine • RoBMA</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Informed Bayesian Model-Averaged Meta-Analysis in Medicine">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RoBMA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.5.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/CustomEnsembles.html">Fitting Custom Meta-Analytic Ensembles</a></li>
    <li><a class="dropdown-item" href="../articles/FastRoBMA.html">Fast Robust Bayesian Meta-Analysis via Spike and Slab Algorithm</a></li>
    <li><a class="dropdown-item" href="../articles/HierarchicalBMA.html">Hierarchical Bayesian Model-Averaged Meta-Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/MedicineBiBMA.html">Informed Bayesian Model-Averaged Meta-Analysis with Binary Outcomes</a></li>
    <li><a class="dropdown-item" href="../articles/MedicineBMA.html">Informed Bayesian Model-Averaged Meta-Analysis in Medicine</a></li>
    <li><a class="dropdown-item" href="../articles/MetaRegression.html">Robust Bayesian Model-Averaged Meta-Regression</a></li>
    <li><a class="dropdown-item" href="../articles/ReproducingBMA.html">Reproducing Bayesian Model-Averaged Meta-Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/Tutorial.html">Tutorial: Adjusting for Publication Bias in JASP and R - Selection Models, PET-PEESE, and Robust Bayesian Meta-Analysis</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/FBartos/RoBMA/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Informed Bayesian Model-Averaged Meta-Analysis in Medicine</h1>
                        <h4 data-toc-skip class="author">František
Bartoš</h4>
            
            <h4 data-toc-skip class="date">2025-07-19</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/FBartos/RoBMA/blob/master/vignettes/MedicineBMA.Rmd" class="external-link"><code>vignettes/MedicineBMA.Rmd</code></a></small>
      <div class="d-none name"><code>MedicineBMA.Rmd</code></div>
    </div>

    
    
<p>Bayesian model-averaged meta-analysis allows researchers to
seamlessly incorporate available prior information into the analysis
<span class="citation">(Bartoš et al., 2021; Gronau et al., 2017,
2021)</span>. This vignette illustrates how to do this with an example
from <span class="citation">Bartoš et al. (2021)</span>, who developed
informed prior distributions for meta-analyses of continuous outcomes
based on the Cochrane database of systematic reviews. Then, we extend
the example by incorporating publication bias adjustment with robust
Bayesian meta-analysis <span class="citation">(Bartoš et al., 2023;
Maier et al., 2023)</span>.</p>
<div class="section level3">
<h3 id="reproducing-informed-bayesian-model-averaged-meta-analysis-bma">Reproducing Informed Bayesian Model-Averaged Meta-Analysis
(BMA)<a class="anchor" aria-label="anchor" href="#reproducing-informed-bayesian-model-averaged-meta-analysis-bma"></a>
</h3>
<p>We illustrate how to fit the informed BMA (not adjusting for
publication bias) using the <code>RoBMA</code> R package. For this
purpose, we reproduce the dentine hypersensitivity example from <span class="citation">Bartoš et al. (2021)</span>, who reanalyzed five
studies with a tactile outcome assessment that were subjected to a
meta-analysis by <span class="citation">Poulsen et al.
(2006)</span>.</p>
<p>We load the dentine hypersensitivity data included in the
package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fbartos.github.io/RoBMA/" class="external-link">RoBMA</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Poulsen2006"</span>, package <span class="op">=</span> <span class="st">"RoBMA"</span><span class="op">)</span></span>
<span><span class="va">Poulsen2006</span></span>
<span><span class="co">#&gt;           d        se               study</span></span>
<span><span class="co">#&gt; 1 0.9073050 0.2720456     STD-Schiff-1994</span></span>
<span><span class="co">#&gt; 2 0.7207589 0.1977769  STD-Silverman-1996</span></span>
<span><span class="co">#&gt; 3 1.3305829 0.2721648   STD-Sowinski-2000</span></span>
<span><span class="co">#&gt; 4 1.7688872 0.2656483 STD-Schiff-2000-(2)</span></span>
<span><span class="co">#&gt; 5 1.3286828 0.3582617     STD-Schiff-1998</span></span></code></pre></div>
<p>To reproduce the analysis from the example, we need to set informed
empirical prior distributions for the effect sizes
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>μ</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>)
and heterogeneity
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>)
parameters that <span class="citation">Bartoš et al. (2021)</span>
obtained from the Cochrane database of systematic reviews. We can either
set them manually,</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_BMA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RoBMA.html">RoBMA</a></span><span class="op">(</span>d <span class="op">=</span> <span class="va">Poulsen2006</span><span class="op">$</span><span class="va">d</span>, se <span class="op">=</span> <span class="va">Poulsen2006</span><span class="op">$</span><span class="va">se</span>, study_names <span class="op">=</span> <span class="va">Poulsen2006</span><span class="op">$</span><span class="va">study</span>,</span>
<span>                 priors_effect        <span class="op">=</span> <span class="fu"><a href="../reference/prior.html">prior</a></span><span class="op">(</span>distribution <span class="op">=</span> <span class="st">"t"</span>, parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>location <span class="op">=</span> <span class="fl">0</span>, scale <span class="op">=</span> <span class="fl">0.51</span>, df <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                 priors_heterogeneity <span class="op">=</span> <span class="fu"><a href="../reference/prior.html">prior</a></span><span class="op">(</span>distribution <span class="op">=</span> <span class="st">"invgamma"</span>, parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">1.79</span>, scale <span class="op">=</span> <span class="fl">0.28</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                 priors_bias          <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                 transformation <span class="op">=</span> <span class="st">"cohens_d"</span>, seed <span class="op">=</span> <span class="fl">1</span>, parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>with <code>priors_effect</code> and <code>priors_heterogeneity</code>
corresponding to the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mo>∼</mo><mi>T</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>0.51</mn><mo>,</mo><mn>5</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\delta \sim T(0,0.51,5)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi><mo>∼</mo><mi>I</mi><mi>n</mi><mi>v</mi><mi>G</mi><mi>a</mi><mi>m</mi><mi>m</mi><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1.79</mn><mo>,</mo><mn>0.28</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\tau \sim InvGamma(1.79,0.28)</annotation></semantics></math>
informed prior distributions for the “oral health” subfield and removing
the publication bias adjustment models by setting
<code>priors_bias = NULL</code><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi></mi><mn>1</mn></msup><annotation encoding="application/x-tex">^1</annotation></semantics></math>.
Note that the package contains function <code><a href="../reference/NoBMA.html">NoBMA()</a></code> from
version 3.1 which skips publication bias adjustment directly.</p>
<p>Alternatively, we can utilize the <code>prior_informed</code>
function that prepares informed prior distributions for the individual
medical subfields automatically.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_BMA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RoBMA.html">RoBMA</a></span><span class="op">(</span>d <span class="op">=</span> <span class="va">Poulsen2006</span><span class="op">$</span><span class="va">d</span>, se <span class="op">=</span> <span class="va">Poulsen2006</span><span class="op">$</span><span class="va">se</span>, study_names <span class="op">=</span> <span class="va">Poulsen2006</span><span class="op">$</span><span class="va">study</span>,</span>
<span>                 priors_effect        <span class="op">=</span> <span class="fu"><a href="../reference/prior_informed.html">prior_informed</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"oral health"</span>, parameter <span class="op">=</span> <span class="st">"effect"</span>, type <span class="op">=</span> <span class="st">"smd"</span><span class="op">)</span>,</span>
<span>                 priors_heterogeneity <span class="op">=</span> <span class="fu"><a href="../reference/prior_informed.html">prior_informed</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"oral health"</span>, parameter <span class="op">=</span> <span class="st">"heterogeneity"</span>, type <span class="op">=</span> <span class="st">"smd"</span><span class="op">)</span>,</span>
<span>                 priors_bias          <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                 transformation <span class="op">=</span> <span class="st">"cohens_d"</span>, seed <span class="op">=</span> <span class="fl">1</span>, parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>The <code>name</code> argument specifies the medical subfield name
(use <code>print(BayesTools::prior_informed_medicine_names)</code> to
check names of all available subfields). The <code>parameter</code>
argument specifies whether we want prior distribution for the effect
size or heterogeneity. Finally, the <code>type</code> argument specifies
what type of measure we use for the meta-analysis (see
<code><a href="../reference/prior_informed.html">?prior_informed</a></code> for more details regarding the informed
prior distributions).</p>
<p>We obtain the output with the <code>summary</code> function. Adding
the <code>conditional = TRUE</code> argument allows us to inspect the
conditional estimates, i.e., the effect size estimate assuming that the
models specifying the presence of the effect are true and the
heterogeneity estimates assuming that the models specifying the presence
of heterogeneity are
true<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi></mi><mn>2</mn></msup><annotation encoding="application/x-tex">^2</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_BMA</span>, conditional <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; RoBMA(d = Poulsen2006$d, se = Poulsen2006$se, study_names = Poulsen2006$study, </span></span>
<span><span class="co">#&gt;     transformation = "cohens_d", priors_effect = prior_informed(name = "oral health", </span></span>
<span><span class="co">#&gt;         parameter = "effect", type = "smd"), priors_heterogeneity = prior_informed(name = "oral health", </span></span>
<span><span class="co">#&gt;         parameter = "heterogeneity", type = "smd"), priors_bias = NULL, </span></span>
<span><span class="co">#&gt;     parallel = TRUE, seed = 1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Robust Bayesian meta-analysis</span></span>
<span><span class="co">#&gt; Components summary:</span></span>
<span><span class="co">#&gt;               Models Prior prob. Post. prob. Inclusion BF</span></span>
<span><span class="co">#&gt; Effect           2/4       0.500       0.995      217.517</span></span>
<span><span class="co">#&gt; Heterogeneity    2/4       0.500       0.778        3.511</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model-averaged estimates:</span></span>
<span><span class="co">#&gt;      Mean Median 0.025 0.975</span></span>
<span><span class="co">#&gt; mu  1.076  1.088 0.664 1.422</span></span>
<span><span class="co">#&gt; tau 0.231  0.208 0.000 0.726</span></span>
<span><span class="co">#&gt; The estimates are summarized on the Cohen's d scale (priors were specified on the Cohen's d scale).</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Conditional estimates:</span></span>
<span><span class="co">#&gt;      Mean Median 0.025 0.975</span></span>
<span><span class="co">#&gt; mu  1.082  1.090 0.701 1.422</span></span>
<span><span class="co">#&gt; tau 0.297  0.255 0.075 0.779</span></span>
<span><span class="co">#&gt; The estimates are summarized on the Cohen's d scale (priors were specified on the Cohen's d scale).</span></span></code></pre></div>
<p>The output from the <code><a href="../reference/summary.RoBMA.html">summary.RoBMA()</a></code> function has 3
parts. The first one under the ‘Robust Bayesian Meta-Analysis’ heading
provides a basic summary of the fitted models by component types
(presence of the Effect and Heterogeneity). The table summarizes the
prior and posterior probabilities and the inclusion Bayes factors of the
individual components. The results show that the inclusion Bayes factor
for the effect corresponds to the one reported in <span class="citation">Bartoš et al. (2021)</span>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">BF</mtext><mn>10</mn></msub><mo>=</mo><mn>218.53</mn></mrow><annotation encoding="application/x-tex">\text{BF}_{10} = 218.53</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">BF</mtext><mtext mathvariant="normal">rf</mtext></msub><mo>=</mo><mn>3.52</mn></mrow><annotation encoding="application/x-tex">\text{BF}_{\text{rf}} = 3.52</annotation></semantics></math>
(up to an MCMC error).</p>
<p>The second part under the ‘Model-averaged estimates’ heading displays
the parameter estimates model-averaged across all specified models
(i.e., including models specifying the effect size to be zero). We
ignore this section and move to the last part.</p>
<p>The third part under the ‘Conditional estimates’ heading displays the
conditional effect size estimate corresponding to the one reported in
<span class="citation">Bartoš et al. (2021)</span>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mo>=</mo><mn>1.082</mn></mrow><annotation encoding="application/x-tex">\delta = 1.082</annotation></semantics></math>,
95% CI [0.686,1.412], and a heterogeneity estimate (not reported
previously).</p>
</div>
<div class="section level3">
<h3 id="visualizing-the-results">Visualizing the Results<a class="anchor" aria-label="anchor" href="#visualizing-the-results"></a>
</h3>
<p>The <code>RoBMA</code> package provides extensive options for
visualizing the results. Here, we visualize the prior (grey) and
posterior (black) distribution for the mean parameter.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_BMA</span>, parameter <span class="op">=</span> <span class="st">"mu"</span>, prior <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="MedicineBMA_files/figure-html/fig_mu_BMA-1.png" width="75%" style="display: block; margin: auto;"></p>
<p>By default, the function plots the model-averaged estimates across
all models; the arrows represent the probability of a spike, and the
lines represent the posterior density under models assuming non-zero
effect. The secondary y-axis (right) shows the probability of the spike
(at value 0) decreasing from 0.50, to 0.005 (also obtainable from the
‘Robust Bayesian Meta-Analysis’ field in <code><a href="../reference/summary.RoBMA.html">summary.RoBMA()</a></code>
function).</p>
<p>To visualize the conditional effect size estimate, we can add the
<code>conditional = TRUE</code> argument,</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_BMA</span>, parameter <span class="op">=</span> <span class="st">"mu"</span>, prior <span class="op">=</span> <span class="cn">TRUE</span>, conditional <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="MedicineBMA_files/figure-html/fig_mu_BMA_cond-1.png" width="75%" style="display: block; margin: auto;">
which displays only the model-averaged posterior distribution of the
effect size parameter for models assuming the presence of the
effect.</p>
<p>We can also visualize the estimates from the individual models used
in the ensemble. We do that with the <code><a href="../reference/plot_models.html">plot_models()</a></code>
function, which visualizes the effect size estimates and 95% CI of each
specified model included in the ensemble. Model 1 corresponds to the
fixed effect model assuming the absence of the effect,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>H</mi><mn>0</mn><mtext mathvariant="normal">f</mtext></msubsup><annotation encoding="application/x-tex">H_0^{\text{f}}</annotation></semantics></math>,
Model 2 corresponds to the random effect model assuming the absence of
the effect,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>H</mi><mn>0</mn><mtext mathvariant="normal">r</mtext></msubsup><annotation encoding="application/x-tex">H_0^{\text{r}}</annotation></semantics></math>,
Model 3 corresponds to the fixed effect model assuming the presence of
the effect,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>H</mi><mn>1</mn><mtext mathvariant="normal">f</mtext></msubsup><annotation encoding="application/x-tex">H_1^{\text{f}}</annotation></semantics></math>,
and Model 4 corresponds to the random effect model assuming the presence
of the effect,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>H</mi><mn>1</mn><mtext mathvariant="normal">r</mtext></msubsup><annotation encoding="application/x-tex">H_1^{\text{r}}</annotation></semantics></math>).
The size of the square representing the mean estimate reflects the
posterior model probability of the model, which is also displayed in the
right-hand side panel. The bottom part of the figure shows the model
averaged-estimate that is a combination of the individual model
posterior distributions weighted by the posterior model
probabilities.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_models.html">plot_models</a></span><span class="op">(</span><span class="va">fit_BMA</span><span class="op">)</span></span></code></pre></div>
<p><img src="MedicineBMA_files/figure-html/fig_models-1.png" width="75%" style="display: block; margin: auto;">
We see that the posterior model probability of the first two models
decreased to essentially zero (when rounding to two decimals),
completely omitting their estimates from the figure. Furthermore, the
much larger box of Model 4 (the random effect model assuming the
presence of the effect) shows that Model 4 received the largest share of
the posterior probability,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>H</mi><mn>1</mn><mtext mathvariant="normal">r</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>0.77</mn></mrow><annotation encoding="application/x-tex">P(H_1^{\text{r}}) = 0.77</annotation></semantics></math>)</p>
<p>The last type of visualization that we show here is the forest plot.
It displays the original studies’ effects and the meta-analytic estimate
within one figure. It can be requested by using the
<code><a href="../reference/forest.html">forest()</a></code> function. Here, we again set the
<code>conditional = TRUE</code> argument to display the conditional
model-averaged effect size estimate at the bottom.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/forest.html">forest</a></span><span class="op">(</span><span class="va">fit_BMA</span>, conditional <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="MedicineBMA_files/figure-html/fig_forest-1.png" width="75%" style="display: block; margin: auto;"></p>
<p>For more options provided by the plotting function, see its
documentation by using <code>?plot.RoBMA()</code>,
<code>?plot_models()</code>, and <code>?forest()</code>.</p>
</div>
<div class="section level3">
<h3 id="adjusting-for-publication-bias-with-robust-bayesian-meta-analysis">Adjusting for Publication Bias with Robust Bayesian
Meta-Analysis<a class="anchor" aria-label="anchor" href="#adjusting-for-publication-bias-with-robust-bayesian-meta-analysis"></a>
</h3>
<p>Finally, we illustrate how to adjust our informed BMA for publication
bias with robust Bayesian meta-analysis <span class="citation">Maier et
al. (2023)</span>. In short, we specify additional models assuming the
presence of the publication bias and correcting for it by either
specifying a selection model operating on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-values
<span class="citation">(Vevea &amp; Hedges, 1995)</span> or by
specifying a publication bias adjustment method correcting for the
relationship between effect sizes and standard errors – PET-PEESE <span class="citation">(Stanley, 2017; Stanley &amp; Doucouliagos,
2014)</span>. See <span class="citation">Bartoš et al. (2022)</span> for
a tutorial.</p>
<p>To obtain a proper before and after publication bias adjustment
comparison, we fit the informed BMA model but using the default effect
size transformation (Fisher’s
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_BMAb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RoBMA.html">RoBMA</a></span><span class="op">(</span>d <span class="op">=</span> <span class="va">Poulsen2006</span><span class="op">$</span><span class="va">d</span>, se <span class="op">=</span> <span class="va">Poulsen2006</span><span class="op">$</span><span class="va">se</span>, study_names <span class="op">=</span> <span class="va">Poulsen2006</span><span class="op">$</span><span class="va">study</span>,</span>
<span>                  priors_effect        <span class="op">=</span> <span class="fu"><a href="../reference/prior_informed.html">prior_informed</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"oral health"</span>, parameter <span class="op">=</span> <span class="st">"effect"</span>, type <span class="op">=</span> <span class="st">"smd"</span><span class="op">)</span>,</span>
<span>                  priors_heterogeneity <span class="op">=</span> <span class="fu"><a href="../reference/prior_informed.html">prior_informed</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"oral health"</span>, parameter <span class="op">=</span> <span class="st">"heterogeneity"</span>, type <span class="op">=</span> <span class="st">"smd"</span><span class="op">)</span>,</span>
<span>                  priors_bias          <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                  seed <span class="op">=</span> <span class="fl">1</span>, parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_BMAb</span>, conditional <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; RoBMA(d = Poulsen2006$d, se = Poulsen2006$se, study_names = Poulsen2006$study, </span></span>
<span><span class="co">#&gt;     priors_effect = prior_informed(name = "oral health", parameter = "effect", </span></span>
<span><span class="co">#&gt;         type = "smd"), priors_heterogeneity = prior_informed(name = "oral health", </span></span>
<span><span class="co">#&gt;         parameter = "heterogeneity", type = "smd"), priors_bias = NULL, </span></span>
<span><span class="co">#&gt;     parallel = TRUE, seed = 1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Robust Bayesian meta-analysis</span></span>
<span><span class="co">#&gt; Components summary:</span></span>
<span><span class="co">#&gt;               Models Prior prob. Post. prob. Inclusion BF</span></span>
<span><span class="co">#&gt; Effect           2/4       0.500       0.997      347.932</span></span>
<span><span class="co">#&gt; Heterogeneity    2/4       0.500       0.723        2.608</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model-averaged estimates:</span></span>
<span><span class="co">#&gt;      Mean Median 0.025 0.975</span></span>
<span><span class="co">#&gt; mu  1.045  1.052 0.705 1.344</span></span>
<span><span class="co">#&gt; tau 0.186  0.163 0.000 0.623</span></span>
<span><span class="co">#&gt; The estimates are summarized on the Cohen's d scale (priors were specified on the Cohen's d scale).</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Conditional estimates:</span></span>
<span><span class="co">#&gt;      Mean Median 0.025 0.975</span></span>
<span><span class="co">#&gt; mu  1.048  1.053 0.720 1.344</span></span>
<span><span class="co">#&gt; tau 0.256  0.220 0.064 0.681</span></span>
<span><span class="co">#&gt; The estimates are summarized on the Cohen's d scale (priors were specified on the Cohen's d scale).</span></span></code></pre></div>
<p>We obtain noticeably stronger evidence for the presence of the
effect. This is a result of placing more weights on the fixed-effect
models, especially the fixed-effect model assuming the presence of the
effect
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>H</mi><mn>1</mn><mi>f</mi></msubsup><annotation encoding="application/x-tex">H_1^f</annotation></semantics></math>.
In our case, the increase in the posterior model probability of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>H</mi><mn>1</mn><mi>f</mi></msubsup><annotation encoding="application/x-tex">H_1^f</annotation></semantics></math>
occurred because this model predicted the data slightly better after
removing the correlation between effect sizes and standard errors (a
consequence of using Fisher’s
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>
transformation). Nevertheless, the conditional effect size estimate
stayed almost the same.</p>
<p>Now, we fit the publication bias-adjusted model by simply removing
the <code>priors_bias = NULL</code> argument, which allows us to obtain
the default 36 models ensemble called RoBMA-PSMA <span class="citation">(Bartoš et al., 2023)</span>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_RoBMA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RoBMA.html">RoBMA</a></span><span class="op">(</span>d <span class="op">=</span> <span class="va">Poulsen2006</span><span class="op">$</span><span class="va">d</span>, se <span class="op">=</span> <span class="va">Poulsen2006</span><span class="op">$</span><span class="va">se</span>, study_names <span class="op">=</span> <span class="va">Poulsen2006</span><span class="op">$</span><span class="va">study</span>,</span>
<span>                   priors_effect        <span class="op">=</span> <span class="fu"><a href="../reference/prior_informed.html">prior_informed</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"oral health"</span>, parameter <span class="op">=</span> <span class="st">"effect"</span>, type <span class="op">=</span> <span class="st">"smd"</span><span class="op">)</span>,</span>
<span>                   priors_heterogeneity <span class="op">=</span> <span class="fu"><a href="../reference/prior_informed.html">prior_informed</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"oral health"</span>, parameter <span class="op">=</span> <span class="st">"heterogeneity"</span>, type <span class="op">=</span> <span class="st">"smd"</span><span class="op">)</span>,</span>
<span>                   seed <span class="op">=</span> <span class="fl">1</span>, parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_RoBMA</span>, conditional <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; RoBMA(d = Poulsen2006$d, se = Poulsen2006$se, study_names = Poulsen2006$study, </span></span>
<span><span class="co">#&gt;     priors_effect = prior_informed(name = "oral health", parameter = "effect", </span></span>
<span><span class="co">#&gt;         type = "smd"), priors_heterogeneity = prior_informed(name = "oral health", </span></span>
<span><span class="co">#&gt;         parameter = "heterogeneity", type = "smd"), parallel = TRUE, </span></span>
<span><span class="co">#&gt;     seed = 1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Robust Bayesian meta-analysis</span></span>
<span><span class="co">#&gt; Components summary:</span></span>
<span><span class="co">#&gt;               Models Prior prob. Post. prob. Inclusion BF</span></span>
<span><span class="co">#&gt; Effect         18/36       0.500       0.858        6.022</span></span>
<span><span class="co">#&gt; Heterogeneity  18/36       0.500       0.714        2.502</span></span>
<span><span class="co">#&gt; Bias           32/36       0.500       0.697        2.304</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model-averaged estimates:</span></span>
<span><span class="co">#&gt;                    Mean Median 0.025  0.975</span></span>
<span><span class="co">#&gt; mu                0.722  0.880 0.000  1.283</span></span>
<span><span class="co">#&gt; tau               0.202  0.161 0.000  0.799</span></span>
<span><span class="co">#&gt; omega[0,0.025]    1.000  1.000 1.000  1.000</span></span>
<span><span class="co">#&gt; omega[0.025,0.05] 0.943  1.000 0.329  1.000</span></span>
<span><span class="co">#&gt; omega[0.05,0.5]   0.874  1.000 0.071  1.000</span></span>
<span><span class="co">#&gt; omega[0.5,0.95]   0.855  1.000 0.042  1.000</span></span>
<span><span class="co">#&gt; omega[0.95,0.975] 0.866  1.000 0.050  1.000</span></span>
<span><span class="co">#&gt; omega[0.975,1]    0.897  1.000 0.057  1.000</span></span>
<span><span class="co">#&gt; PET               0.931  0.000 0.000  4.927</span></span>
<span><span class="co">#&gt; PEESE             1.131  0.000 0.000 12.261</span></span>
<span><span class="co">#&gt; The estimates are summarized on the Cohen's d scale (priors were specified on the Cohen's d scale).</span></span>
<span><span class="co">#&gt; (Estimated publication weights omega correspond to one-sided p-values.)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Conditional estimates:</span></span>
<span><span class="co">#&gt;                    Mean Median  0.025  0.975</span></span>
<span><span class="co">#&gt; mu                0.838  0.938 -0.035  1.297</span></span>
<span><span class="co">#&gt; tau               0.285  0.227  0.064  0.906</span></span>
<span><span class="co">#&gt; omega[0,0.025]    1.000  1.000  1.000  1.000</span></span>
<span><span class="co">#&gt; omega[0.025,0.05] 0.736  0.829  0.092  1.000</span></span>
<span><span class="co">#&gt; omega[0.05,0.5]   0.411  0.373  0.014  0.951</span></span>
<span><span class="co">#&gt; omega[0.5,0.95]   0.320  0.249  0.008  0.919</span></span>
<span><span class="co">#&gt; omega[0.95,0.975] 0.376  0.311  0.009  0.958</span></span>
<span><span class="co">#&gt; omega[0.975,1]    0.518  0.425  0.010  1.000</span></span>
<span><span class="co">#&gt; PET               2.909  3.136  0.171  5.614</span></span>
<span><span class="co">#&gt; PEESE             7.048  6.034  0.375 18.162</span></span>
<span><span class="co">#&gt; The estimates are summarized on the Cohen's d scale (priors were specified on the Cohen's d scale).</span></span>
<span><span class="co">#&gt; (Estimated publication weights omega correspond to one-sided p-values.)</span></span></code></pre></div>
<p>We notice the additional values in the ‘Components summary’ table in
the ‘Bias’ row. The model is now extended with 32 publication bias
adjustment models that account for 50% of the prior model probability.
When comparing the RoBMA to the second BMA fit, we notice a large
decrease in the inclusion Bayes factor for the presence of the effect
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">BF</mtext><mn>10</mn></msub><mo>=</mo><mn>6.02</mn></mrow><annotation encoding="application/x-tex">\text{BF}_{10} = 6.02</annotation></semantics></math>
vs. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">BF</mtext><mn>10</mn></msub><mo>=</mo><mn>347.93</mn></mrow><annotation encoding="application/x-tex">\text{BF}_{10} = 347.93</annotation></semantics></math>,
which still, however, presents moderate evidence for the presence of the
effect. We can further quantify the evidence in favor of the publication
bias with the inclusion Bayes factor for publication bias
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">BF</mtext><mrow><mi>p</mi><mi>b</mi></mrow></msub><mo>=</mo><mn>2.30</mn></mrow><annotation encoding="application/x-tex">\text{BF}_{pb} = 2.30</annotation></semantics></math>,
which can be interpreted as weak evidence in favor of publication
bias.</p>
<p>We can also compare the publication bias unadjusted and publication
bias-adjusted conditional effect size estimates. Including models
assuming publication bias into our model-averaged estimate (assuming the
presence of the effect) slightly decreases the estimated effect to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mo>=</mo><mn>0.838</mn></mrow><annotation encoding="application/x-tex">\delta = 0.838</annotation></semantics></math>,
95% CI [-0.035, 1.297] with a much wider confidence interval, as
visualized in the prior and posterior conditional effect size estimate
plot.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_RoBMA</span>, parameter <span class="op">=</span> <span class="st">"mu"</span>, prior <span class="op">=</span> <span class="cn">TRUE</span>, conditional <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="MedicineBMA_files/figure-html/fig_mu_RoBMA_cond-1.png" width="75%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="footnotes">Footnotes<a class="anchor" aria-label="anchor" href="#footnotes"></a>
</h3>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi></mi><mn>1</mn></msup><annotation encoding="application/x-tex">^1</annotation></semantics></math>
The additional setting <code>transformation = "cohens_d"</code> allows
us to get more comparable results with the <code>metaBMA</code> R
package since RoBMA otherwise internally transforms the effect sizes to
Fisher’s
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>
for the fitting purposes. The <code>seed = 1</code> and
<code>parallel = TRUE</code> options grant us exact reproducibility of
the results and parallelization of the fitting process.</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi></mi><mn>2</mn></msup><annotation encoding="application/x-tex">^2</annotation></semantics></math>
The model-averaged estimates that <code>RoBMA</code> returns by default
model-averaged across all specified models – a different behavior from
the <code>metaBMA</code> package that by default returns what we call
“conditional” estimates in <code>RoBMA</code>.</p>
</div>
<div class="section level3 unnumbered">
<h3 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0" line-spacing="2">
<div id="ref-bartos2021bayesian" class="csl-entry">
Bartoš, F., Gronau, Q. F., Timmers, B., Otte, W. M., Ly, A., &amp;
Wagenmakers, E.-J. (2021). Bayesian model-averaged meta-analysis in
medicine. <em>Statistics in Medicine</em>, <em>40</em>(30), 6743–6761.
<a href="https://doi.org/10.1002/sim.9170" class="external-link">https://doi.org/10.1002/sim.9170</a>
</div>
<div id="ref-bartos2020adjusting" class="csl-entry">
Bartoš, F., Maier, Maximilian, Quintana, D. S., &amp; Wagenmakers, E.-J.
(2022). Adjusting for publication bias in <span>JASP</span> and
<span>R</span> — <span>S</span>election models, <span>PET-PEESE</span>,
and robust <span>B</span>ayesian meta-analysis. <em>Advances in Methods
and Practices in Psychological Science</em>, <em>5</em>(3), 1–19. <a href="https://doi.org/10.1177/25152459221109259" class="external-link">https://doi.org/10.1177/25152459221109259</a>
</div>
<div id="ref-bartos2021no" class="csl-entry">
Bartoš, F., Maier, M., Wagenmakers, E.-J., Doucouliagos, H., &amp;
Stanley, T. D. (2023). Robust <span>B</span>ayesian meta-analysis:
<span>M</span>odel-averaging across complementary publication bias
adjustment methods. <em>Research Synthesis Methods</em>, <em>14</em>(1),
99–116. <a href="https://doi.org/10.1002/jrsm.1594" class="external-link">https://doi.org/10.1002/jrsm.1594</a>
</div>
<div id="ref-gronau2020primer" class="csl-entry">
Gronau, Q. F., Heck, D. W., Berkhout, S. W., Haaf, J. M., &amp;
Wagenmakers, E.-J. (2021). A primer on <span>B</span>ayesian
model-averaged meta-analysis. <em>Advances in Methods and Practices in
Psychological Science</em>, <em>4</em>(3), 1–19. <a href="https://doi.org/10.1177/25152459211031256" class="external-link">https://doi.org/10.1177/25152459211031256</a>
</div>
<div id="ref-gronau2017bayesian" class="csl-entry">
Gronau, Q. F., Van Erp, S., Heck, D. W., Cesario, J., Jonas, K. J.,
&amp; Wagenmakers, E.-J. (2017). A <span>B</span>ayesian model-averaged
meta-analysis of the power pose effect with informed and default priors:
<span>T</span>he case of felt power. <em>Comprehensive Results in Social
Psychology</em>, <em>2</em>(1), 123–138. <a href="https://doi.org/10.1080/23743603.2017.1326760" class="external-link">https://doi.org/10.1080/23743603.2017.1326760</a>
</div>
<div id="ref-maier2020robust" class="csl-entry">
Maier, M., Bartoš, F., &amp; Wagenmakers, E.-J. (2023). Robust
<span>B</span>ayesian meta-analysis: <span>A</span>ddressing publication
bias with model-averaging. <em>Psychological Methods</em>,
<em>28</em>(1), 107–122. <a href="https://doi.org/10.1037/met0000405" class="external-link">https://doi.org/10.1037/met0000405</a>
</div>
<div id="ref-poulsen2006potassium" class="csl-entry">
Poulsen, S., Errboe, M., Mevil, Y. L., &amp; Glenny, A.-M. (2006).
Potassium containing toothpastes for dentine hypersensitivity.
<em>Cochrane Database of Systematic Reviews</em>, <em>3</em>. <a href="https://doi.org/10.1002/14651858.cd001476.pub2" class="external-link">https://doi.org/10.1002/14651858.cd001476.pub2</a>
</div>
<div id="ref-stanley2017limitations" class="csl-entry">
Stanley, T. D. (2017). Limitations of <span>PET-PEESE</span> and other
meta-analysis methods. <em>Social Psychological and Personality
Science</em>, <em>8</em>(5), 581–591. <a href="https://doi.org/10.1177/1948550617693062" class="external-link">https://doi.org/10.1177/1948550617693062</a>
</div>
<div id="ref-stanley2014meta" class="csl-entry">
Stanley, T. D., &amp; Doucouliagos, H. (2014). Meta-regression
approximations to reduce publication selection bias. <em>Research
Synthesis Methods</em>, <em>5</em>(1), 60–78. <a href="https://doi.org/10.1002/jrsm.1095" class="external-link">https://doi.org/10.1002/jrsm.1095</a>
</div>
<div id="ref-vevea1995general" class="csl-entry">
Vevea, J. L., &amp; Hedges, L. V. (1995). A general linear model for
estimating effect size in the presence of publication bias.
<em>Psychometrika</em>, <em>60</em>(3), 419–435. <a href="https://doi.org/10.1007/BF02294384" class="external-link">https://doi.org/10.1007/BF02294384</a>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by František Bartoš, Maximilian Maier.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
