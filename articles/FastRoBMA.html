<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Fast Robust Bayesian Meta-Analysis via Spike and Slab Algorithm • RoBMA</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fast Robust Bayesian Meta-Analysis via Spike and Slab Algorithm">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RoBMA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.5.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/CustomEnsembles.html">Fitting Custom Meta-Analytic Ensembles</a></li>
    <li><a class="dropdown-item" href="../articles/FastRoBMA.html">Fast Robust Bayesian Meta-Analysis via Spike and Slab Algorithm</a></li>
    <li><a class="dropdown-item" href="../articles/HierarchicalBMA.html">Hierarchical Bayesian Model-Averaged Meta-Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/MedicineBiBMA.html">Informed Bayesian Model-Averaged Meta-Analysis with Binary Outcomes</a></li>
    <li><a class="dropdown-item" href="../articles/MedicineBMA.html">Informed Bayesian Model-Averaged Meta-Analysis in Medicine</a></li>
    <li><a class="dropdown-item" href="../articles/MetaRegression.html">Robust Bayesian Model-Averaged Meta-Regression</a></li>
    <li><a class="dropdown-item" href="../articles/ReproducingBMA.html">Reproducing Bayesian Model-Averaged Meta-Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/Tutorial.html">Tutorial: Adjusting for Publication Bias in JASP and R - Selection Models, PET-PEESE, and Robust Bayesian Meta-Analysis</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/FBartos/RoBMA/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Fast Robust Bayesian Meta-Analysis via Spike and Slab Algorithm</h1>
                        <h4 data-toc-skip class="author">František
Bartoš</h4>
            
            <h4 data-toc-skip class="date">2025-07-22</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/FBartos/RoBMA/blob/master/vignettes/FastRoBMA.Rmd" class="external-link"><code>vignettes/FastRoBMA.Rmd</code></a></small>
      <div class="d-none name"><code>FastRoBMA.Rmd</code></div>
    </div>

    
    
<p>This vignette demonstrates how to fit a robust Bayesian
model-averaged meta-regression (<code><a href="../reference/RoBMA.reg.html">RoBMA.reg()</a></code>) in the
<code>RoBMA</code> R package using two different algorithms:</p>
<ul>
<li>Bridge sampling (the current default,
<code>algorithm = "bridge"</code>),</li>
<li>Spike-and-slab (<code>algorithm = "ss"</code>).</li>
</ul>
<p>We compare both approaches in terms of fitting time, side-by-side
summaries, marginal summaries, and illustrative plots. We then discuss
advantages and disadvantages of the spike-and-slab approach, especially
for complex meta-regression with multiple moderators. We will use the
example from <span class="citation">(Bartoš et al., 2025)</span> which
focuses on the effect of household chaos on child executive functions
with two moderators: assessment type (measure: “direct” vs. “informant”)
and mean child age (age). See <span class="citation">(Bartoš et al.,
2025)</span> and <a href="MetaRegression.html">Robust Bayesian
Model-Averaged Meta-Regression</a> vignette for in depth discussion of
the example and guidance on applying robust Bayesian model-averaged
meta-regression. Here, we show that both algorithms produce essentially
identical results; however, spike-and-slab can be much faster when many
moderators (hence many models) are present. Note that the spike-and-slab
algorithm can be also applied in the case of hierarchical (3-lvl) models
(see <a href="HierarchicalBMA.html">Hierarchical Bayesian Model-Averaged
Meta-Analysis</a>) which makes hierarchical approximate selection models
feasible.</p>
<div class="section level3">
<h3 id="fitting-models-via-bridge-sampling-vs--spike-and-slab">Fitting Models via Bridge Sampling vs. Spike-and-Slab<a class="anchor" aria-label="anchor" href="#fitting-models-via-bridge-sampling-vs--spike-and-slab"></a>
</h3>
<p>Below, we specify and fit the same meta-regression with publication
bias adjustment using the two algorithms. First, we load the package and
inspect the data set.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fbartos.github.io/RoBMA/" class="external-link">RoBMA</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Andrews2021"</span>, package <span class="op">=</span> <span class="st">"RoBMA"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Andrews2021</span><span class="op">)</span></span>
<span><span class="co">#&gt;       r         se measure      age</span></span>
<span><span class="co">#&gt; 1 0.070 0.04743416  direct 4.606660</span></span>
<span><span class="co">#&gt; 2 0.033 0.04371499  direct 2.480833</span></span>
<span><span class="co">#&gt; 3 0.170 0.10583005  direct 7.750000</span></span>
<span><span class="co">#&gt; 4 0.208 0.08661986  direct 4.000000</span></span>
<span><span class="co">#&gt; 5 0.270 0.02641969  direct 4.000000</span></span>
<span><span class="co">#&gt; 6 0.170 0.05147815  direct 4.487500</span></span></code></pre></div>
<p>Second, we estimate the meta-regression models using the two
algorithms. We use the same formula, data, and settings for both
algorithms. The bridge sampling approach is specified with
<code>algorithm = "bridge"</code>, while the spike-and-slab approach is
specified with <code>algorithm = "ss"</code>. We use the current default
settings for the number of chains, samples, burn-in, and adaptation
settings for the bridge algorithm, however, we significantly increase
the number of chains and samples for the spike-and-slab algorithm to
ensure convergence. This is important as the spike-and-slab algorithm
estimates the complete model-averaged ensemble within a single MCMC run,
while the bridge algorithm estimates each model separately and then
combines them. We also time the estimation process for comparison using
the <code><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time()</a></code> function.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Bridge sampling</span></span>
<span><span class="va">t1_bridge</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">fit_RoBMA.bridge</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RoBMA.reg.html">RoBMA.reg</a></span><span class="op">(</span></span>
<span>  formula   <span class="op">=</span> <span class="op">~</span> <span class="va">measure</span> <span class="op">+</span> <span class="va">age</span>,</span>
<span>  data      <span class="op">=</span> <span class="va">Andrews2021</span>,</span>
<span>  algorithm <span class="op">=</span> <span class="st">"bridge"</span>, </span>
<span>  chains    <span class="op">=</span> <span class="fl">3</span>, </span>
<span>  sample    <span class="op">=</span> <span class="fl">5000</span>, </span>
<span>  burnin    <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  adapt     <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  parallel  <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">t2_bridge</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Spike-and-slab</span></span>
<span><span class="va">t1_ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">fit_RoBMA.ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RoBMA.reg.html">RoBMA.reg</a></span><span class="op">(</span></span>
<span>  formula   <span class="op">=</span> <span class="op">~</span> <span class="va">measure</span> <span class="op">+</span> <span class="va">age</span>,</span>
<span>  data      <span class="op">=</span> <span class="va">Andrews2021</span>,</span>
<span>  algorithm <span class="op">=</span> <span class="st">"ss"</span>, </span>
<span>  chains    <span class="op">=</span> <span class="fl">6</span>, </span>
<span>  sample    <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  burnin    <span class="op">=</span> <span class="fl">2500</span>,</span>
<span>  adapt     <span class="op">=</span> <span class="fl">2500</span>,</span>
<span>  parallel  <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">t2_ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Once the models are fitted, we compute the time taken to fit each
model.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bridge_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/difftime.html" class="external-link">difftime</a></span><span class="op">(</span><span class="va">t2_bridge</span>, <span class="va">t1_bridge</span>, units <span class="op">=</span> <span class="st">"mins"</span><span class="op">)</span></span>
<span><span class="va">ss_time</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/difftime.html" class="external-link">difftime</a></span><span class="op">(</span><span class="va">t2_ss</span>, <span class="va">t1_ss</span>, units <span class="op">=</span> <span class="st">"mins"</span><span class="op">)</span></span></code></pre></div>
<p>Running on a high-performing laptop with a 6c/12t Intel CPU, the
bridge sampling approach took about 24 minutes, while the spike-and-slab
approach took ~0.58 minutes. This highlights the efficiency advantage of
the spike-and-slab algorithm as the number of moderators (and hence the
number of potential models) grows. This is especially important as the
number of models grows following 36x2^p, where p corresponds the number
of moderators. For example, with 3 moderators, the number of models is
36x2^3 = 288, and with 4 moderators, the number of models is 36x2^4 =
576 (more is essentially unattainable on a consumer PC).</p>
</div>
<div class="section level3">
<h3 id="comparing-summary-outputs">Comparing Summary Outputs<a class="anchor" aria-label="anchor" href="#comparing-summary-outputs"></a>
</h3>
<p>Below we compare the numeric summaries using the
<code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> for each fitted object.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_RoBMA.bridge</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; RoBMA.reg(formula = ~measure + age, data = Andrews2021, algorithm = "bridge", </span></span>
<span><span class="co">#&gt;     chains = 3, sample = 5000, burnin = 2000, adapt = 500, parallel = TRUE)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Robust Bayesian meta-regression</span></span>
<span><span class="co">#&gt; Components summary:</span></span>
<span><span class="co">#&gt;                Models Prior prob. Post. prob. Inclusion BF</span></span>
<span><span class="co">#&gt; Effect         72/144       0.500       0.337 5.080000e-01</span></span>
<span><span class="co">#&gt; Heterogeneity  72/144       0.500       1.000 1.043245e+23</span></span>
<span><span class="co">#&gt; Bias          128/144       0.500       0.965 2.796700e+01</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Meta-regression components summary:</span></span>
<span><span class="co">#&gt;         Models Prior prob. Post. prob. Inclusion BF</span></span>
<span><span class="co">#&gt; measure 72/144       0.500       0.950       18.955</span></span>
<span><span class="co">#&gt; age     72/144       0.500       0.154        0.181</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model-averaged estimates:</span></span>
<span><span class="co">#&gt;                    Mean Median 0.025 0.975</span></span>
<span><span class="co">#&gt; mu                0.064  0.000 0.000 0.328</span></span>
<span><span class="co">#&gt; tau               0.212  0.208 0.149 0.297</span></span>
<span><span class="co">#&gt; omega[0,0.025]    1.000  1.000 1.000 1.000</span></span>
<span><span class="co">#&gt; omega[0.025,0.05] 0.999  1.000 1.000 1.000</span></span>
<span><span class="co">#&gt; omega[0.05,0.5]   0.998  1.000 1.000 1.000</span></span>
<span><span class="co">#&gt; omega[0.5,0.95]   0.996  1.000 1.000 1.000</span></span>
<span><span class="co">#&gt; omega[0.95,0.975] 0.996  1.000 1.000 1.000</span></span>
<span><span class="co">#&gt; omega[0.975,1]    0.997  1.000 1.000 1.000</span></span>
<span><span class="co">#&gt; PET               2.046  2.487 0.000 3.292</span></span>
<span><span class="co">#&gt; PEESE             1.006  0.000 0.000 9.780</span></span>
<span><span class="co">#&gt; The estimates are summarized on the Cohen's d scale (priors were specified on the Cohen's d scale).</span></span>
<span><span class="co">#&gt; (Estimated publication weights omega correspond to one-sided p-values.)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model-averaged meta-regression estimates:</span></span>
<span><span class="co">#&gt;                            Mean Median  0.025 0.975</span></span>
<span><span class="co">#&gt; intercept                 0.064  0.000  0.000 0.328</span></span>
<span><span class="co">#&gt; measure [dif: direct]    -0.125 -0.129 -0.214 0.000</span></span>
<span><span class="co">#&gt; measure [dif: informant]  0.125  0.129  0.000 0.214</span></span>
<span><span class="co">#&gt; age                       0.000  0.000 -0.044 0.044</span></span>
<span><span class="co">#&gt; The estimates are summarized on the Cohen's d scale (priors were specified on the Cohen's d scale).</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_RoBMA.ss</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; RoBMA.reg(formula = ~measure + age, data = Andrews2021, algorithm = "ss", </span></span>
<span><span class="co">#&gt;     chains = 6, sample = 10000, burnin = 2500, adapt = 2500, </span></span>
<span><span class="co">#&gt;     parallel = TRUE)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Robust Bayesian meta-regression</span></span>
<span><span class="co">#&gt; Components summary:</span></span>
<span><span class="co">#&gt;               Prior prob. Post. prob. Inclusion BF</span></span>
<span><span class="co">#&gt; Effect              0.500       0.333        0.499</span></span>
<span><span class="co">#&gt; Heterogeneity       0.500       1.000          Inf</span></span>
<span><span class="co">#&gt; Bias                0.500       0.966       28.340</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Meta-regression components summary:</span></span>
<span><span class="co">#&gt;         Prior prob. Post. prob. Inclusion BF</span></span>
<span><span class="co">#&gt; measure       0.500       0.953       20.307</span></span>
<span><span class="co">#&gt; age           0.500       0.151        0.178</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model-averaged estimates:</span></span>
<span><span class="co">#&gt;                    Mean Median 0.025  0.975</span></span>
<span><span class="co">#&gt; mu                0.062  0.000 0.000  0.331</span></span>
<span><span class="co">#&gt; tau               0.211  0.207 0.148  0.297</span></span>
<span><span class="co">#&gt; omega[0,0.025]    1.000  1.000 1.000  1.000</span></span>
<span><span class="co">#&gt; omega[0.025,0.05] 0.999  1.000 1.000  1.000</span></span>
<span><span class="co">#&gt; omega[0.05,0.5]   0.998  1.000 1.000  1.000</span></span>
<span><span class="co">#&gt; omega[0.5,0.95]   0.996  1.000 1.000  1.000</span></span>
<span><span class="co">#&gt; omega[0.95,0.975] 0.996  1.000 1.000  1.000</span></span>
<span><span class="co">#&gt; omega[0.975,1]    0.996  1.000 1.000  1.000</span></span>
<span><span class="co">#&gt; PET               2.059  2.504 0.000  3.301</span></span>
<span><span class="co">#&gt; PEESE             1.008  0.000 0.000 10.123</span></span>
<span><span class="co">#&gt; The estimates are summarized on the Cohen's d scale (priors were specified on the Cohen's d scale).</span></span>
<span><span class="co">#&gt; (Estimated publication weights omega correspond to one-sided p-values.)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model-averaged meta-regression estimates:</span></span>
<span><span class="co">#&gt;                            Mean Median  0.025 0.975</span></span>
<span><span class="co">#&gt; intercept                 0.062  0.000  0.000 0.331</span></span>
<span><span class="co">#&gt; measure [dif: direct]    -0.125 -0.128 -0.214 0.000</span></span>
<span><span class="co">#&gt; measure [dif: informant]  0.125  0.128  0.000 0.214</span></span>
<span><span class="co">#&gt; age                       0.000  0.000 -0.045 0.043</span></span>
<span><span class="co">#&gt; The estimates are summarized on the Cohen's d scale (priors were specified on the Cohen's d scale).</span></span></code></pre></div>
<p>The posterior probabilities for each component are very similar. For
example, the posterior probability of including the measure moderator is
≈ 0.95 in both fits, and the probability of including the age moderator
is ≈ 0.15. The posterior mean estimates for mu, tau, and the regression
coefficients are essentially the same (differences are within the 3rd
decimal place). Inclusion Bayes factors differ very slightly (0.499
vs. 0.508, etc.) but not in any meaningful or qualitatively different
way. Hence, both algorithms yield consistent inferences but differ
drastically in computation time when there are many models to evaluate.
Visual inspection of the posterior distributions for the effect size and
the moderators reveals that the two algorithms produce nearly identical
results.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_RoBMA.bridge</span>, parameter <span class="op">=</span> <span class="st">"mu"</span>, prior <span class="op">=</span> <span class="cn">TRUE</span>, main <span class="op">=</span> <span class="st">"Bridge Sampling"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_RoBMA.ss</span>,     parameter <span class="op">=</span> <span class="st">"mu"</span>, prior <span class="op">=</span> <span class="cn">TRUE</span>, main <span class="op">=</span> <span class="st">"Spike-and-Slab"</span><span class="op">)</span></span></code></pre></div>
<p><img src="FastRoBMA_files/figure-html/fig_effect-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>Next, we compare the marginal estimates for the moderators at each
level of measure, and age (centered at -1 SD, 0 SD, +1 SD,
respectively). These “marginal means” clarify the estimated
model-averaged effect for each factor level. We use the
<code><a href="../reference/marginal_summary.html">marginal_summary()</a></code> function to extract these summaries.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/marginal_summary.html">marginal_summary</a></span><span class="op">(</span><span class="va">fit_RoBMA.bridge</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; RoBMA.reg(formula = ~measure + age, data = Andrews2021, algorithm = "bridge", </span></span>
<span><span class="co">#&gt;     chains = 3, sample = 5000, burnin = 2000, adapt = 500, parallel = TRUE)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Robust Bayesian meta-analysis</span></span>
<span><span class="co">#&gt; Model-averaged marginal estimates:</span></span>
<span><span class="co">#&gt;                      Mean Median  0.025 0.975 Inclusion BF</span></span>
<span><span class="co">#&gt; intercept           0.064  0.000  0.000 0.328        0.508</span></span>
<span><span class="co">#&gt; measure[direct]    -0.061 -0.108 -0.208 0.246        0.844</span></span>
<span><span class="co">#&gt; measure[informant]  0.188  0.156  0.000 0.458        8.950</span></span>
<span><span class="co">#&gt; age[-1SD]           0.064  0.000 -0.030 0.326        0.300</span></span>
<span><span class="co">#&gt; age[0SD]            0.064  0.000  0.000 0.328        0.356</span></span>
<span><span class="co">#&gt; age[1SD]            0.064  0.000 -0.043 0.335        0.307</span></span>
<span><span class="co">#&gt; The estimates are summarized on the Cohen's d scale (priors were specified on the Cohen's d scale).</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">mu_age[0SD]: There is a considerable cluster of posterior samples at the exact null hypothesis values. The Savage-Dickey density ratio is likely to be invalid.</span></span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">mu_age[0SD]: There is a considerable cluster of prior samples at the exact null hypothesis values. The Savage-Dickey density ratio is likely to be invalid.</span></span></span>
<span><span class="fu"><a href="../reference/marginal_summary.html">marginal_summary</a></span><span class="op">(</span><span class="va">fit_RoBMA.ss</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; RoBMA.reg(formula = ~measure + age, data = Andrews2021, algorithm = "ss", </span></span>
<span><span class="co">#&gt;     chains = 6, sample = 10000, burnin = 2500, adapt = 2500, </span></span>
<span><span class="co">#&gt;     parallel = TRUE)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Robust Bayesian meta-analysis</span></span>
<span><span class="co">#&gt; Model-averaged marginal estimates:</span></span>
<span><span class="co">#&gt;                      Mean Median  0.025 0.975 Inclusion BF</span></span>
<span><span class="co">#&gt; intercept           0.062  0.000  0.000 0.331        0.492</span></span>
<span><span class="co">#&gt; measure[direct]    -0.063 -0.108 -0.211 0.241        0.781</span></span>
<span><span class="co">#&gt; measure[informant]  0.187  0.154  0.000 0.460        8.639</span></span>
<span><span class="co">#&gt; age[-1SD]           0.062  0.000 -0.031 0.328        0.298</span></span>
<span><span class="co">#&gt; age[0SD]            0.062  0.000  0.000 0.331        0.310</span></span>
<span><span class="co">#&gt; age[1SD]            0.062  0.000 -0.047 0.340        0.296</span></span>
<span><span class="co">#&gt; The estimates are summarized on the Cohen's d scale (priors were specified on the Cohen's d scale).</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">mu_age[0SD]: There is a considerable cluster of posterior samples at the exact null hypothesis values. The Savage-Dickey density ratio is likely to be invalid.</span></span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">mu_age[0SD]: There is a considerable cluster of prior samples at the exact null hypothesis values. The Savage-Dickey density ratio is likely to be invalid.</span></span></span></code></pre></div>
<p>Again, the mean estimates differ only in the third decimal place and
the differences in the inclusion BF are qualitatively equal (e.g., 8.950
vs. 8.639 for the inclusion Bayes factor at the measure[informant]
level). A visual comparison of the estimated marginal means reveals that
the two algorithms produce nearly identical results.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/marginal_plot.html">marginal_plot</a></span><span class="op">(</span><span class="va">fit_RoBMA.bridge</span>, parameter <span class="op">=</span> <span class="st">"measure"</span>, conditional <span class="op">=</span> <span class="cn">TRUE</span>, prior <span class="op">=</span> <span class="cn">TRUE</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">7</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Bridge Sampling"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/marginal_plot.html">marginal_plot</a></span><span class="op">(</span><span class="va">fit_RoBMA.ss</span>,     parameter <span class="op">=</span> <span class="st">"measure"</span>, conditional <span class="op">=</span> <span class="cn">TRUE</span>, prior <span class="op">=</span> <span class="cn">TRUE</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">7</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Spike-and-Slab"</span><span class="op">)</span></span></code></pre></div>
<p><img src="FastRoBMA_files/figure-html/fig_marginal-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h3>
<p>Spike-and-slab (<code>algorithm = "ss"</code>) is much faster than
bridge sampling (<code>algorithm = "bridge"</code>) for estimating
robust Bayesian meta-analysis model ensembles. This advantage further
extends in cases of meta-regression models involving many predictors.
Despite huge differences in computation time, both algorithms produce
nearly identical inferences for model-averaged effect sizes, moderator
effects, and posterior probabilities. Currently, the
<code>"bridge"</code> algorithm remains the default option in the
<code>RoBMA</code> R package but future major releases will switch to
the <code>"ss"</code> algorithms the new default (and modify the default
MCMC settings).</p>
</div>
<div class="section level3 unnumbered">
<h3 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0" line-spacing="2">
<div id="ref-bartos2023robust" class="csl-entry">
Bartoš, F., Maier, M., Stanley, T., &amp; Wagenmakers, E.-J. (2025).
Robust <span>B</span>ayesian meta-regression:
<span>M</span>odel-averaged moderation analysis in the presence of
publication bias. <em>Psychological Methods</em>. <a href="https://doi.org/10.1037/met0000737" class="external-link">https://doi.org/10.1037/met0000737</a>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by František Bartoš, Maximilian Maier.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
